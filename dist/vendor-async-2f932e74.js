(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[2570],{2308:(e,t,n)=>{"use strict";n.d(t,{Wv:()=>V,jA:()=>H,yk:()=>X});var i,o,r,a,s=n(80315),d=n(69440),c={};function u(e,t){return Object.assign(e,{resolveIds:t})}c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class l extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class p extends l{constructor(e){super(e||"Unable to proceed because the client library of a payment method has thrown an unexpected error."),this.name="PaymentMethodFailedError",this.type="payment_method_client_invalid"}}function h(e,t){if(null==e)throw t?t():new Error("An unexpected error has occurred.");return e}(o=i||(i={}))[o.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",o[o.CustomerNotInitialized=1]="CustomerNotInitialized",o[o.PaymentNotInitialized=2]="PaymentNotInitialized",o[o.ShippingNotInitialized=3]="ShippingNotInitialized",o[o.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized";class m extends l{constructor(e){super(function(e){switch(e){case i.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case i.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case i.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case i.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(e)),this.subtype=e,this.name="NotInitializedError",this.type="not_initialized"}}class f{initialize(e){this._blueSnapSdk=e}initialize3ds(e,t){return n=this,o=function*(){const n=this._getBlueSnapSdk();return new Promise(((i,o)=>{n.threeDsPaymentsSetup(e,(e=>"1"===e.code?i(e.threeDSecure.threeDSecureReferenceId):o(new p))),n.threeDsPaymentsSubmitData(t)}))},new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{s(o.next(e))}catch(e){t(e)}}function a(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}s((o=o.apply(n,[])).next())}));var n,i,o}_getBlueSnapSdk(){return h(this._blueSnapSdk,(()=>new m(i.PaymentNotInitialized)))}}class y extends l{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class g extends y{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}function v(e){return!("object"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&"boolean"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&"boolean"!=typeof e.shouldSetAsDefaultInstrument)}function b(e){return Boolean(e.instrumentId)}class w extends l{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}!function(e){e[e.MissingBillingAddress=0]="MissingBillingAddress",e[e.MissingCart=1]="MissingCart",e[e.MissingCheckout=2]="MissingCheckout",e[e.MissingConsignments=3]="MissingConsignments",e[e.MissingCustomer=4]="MissingCustomer",e[e.MissingCheckoutConfig=5]="MissingCheckoutConfig",e[e.MissingOrder=6]="MissingOrder",e[e.MissingOrderConfig=7]="MissingOrderConfig",e[e.MissingOrderId=8]="MissingOrderId",e[e.MissingPayment=9]="MissingPayment",e[e.MissingPaymentId=10]="MissingPaymentId",e[e.MissingPaymentInstrument=11]="MissingPaymentInstrument",e[e.MissingPaymentMethod=12]="MissingPaymentMethod",e[e.MissingPaymentRedirectUrl=13]="MissingPaymentRedirectUrl",e[e.MissingPaymentStatus=14]="MissingPaymentStatus",e[e.MissingPaymentToken=15]="MissingPaymentToken",e[e.MissingShippingAddress=16]="MissingShippingAddress"}(r||(r={}));class S extends l{constructor(e){super(function(e){switch(e){case r.MissingBillingAddress:return"Unable to proceed because billing address data is unavailable.";case r.MissingCart:return"Unable to proceed because cart data is unavailable.";case r.MissingConsignments:return"Unable to proceed because consignments data is unavailable.";case r.MissingCheckout:return"Unable to proceed because checkout data is unavailable.";case r.MissingCustomer:return"Unable to proceed because customer data is unavailable.";case r.MissingCheckoutConfig:case r.MissingOrderConfig:return"Unable to proceed because configuration data is unavailable.";case r.MissingOrder:return"Unable to proceed because order data is unavailable.";case r.MissingOrderId:return"Unable to proceed because order ID is unavailable or not generated yet.";case r.MissingPayment:return"Unable to proceed because payment data is unavailable.";case r.MissingPaymentToken:return"Unable to proceed because the token required to submit a payment is missing.";case r.MissingPaymentMethod:return"Unable to proceed because payment method data is unavailable or not properly configured.";case r.MissingShippingAddress:return"Unable to proceed because shipping address data is unavailable.";default:return"Unable to proceed because the required data is unavailable."}}(e)),this.subtype=e,this.name="MissingDataError",this.type="missing_data"}}!function(e){e.CardCode="cardCode",e.CardCodeVerification="cardCodeVerification",e.CardExpiry="cardExpiry",e.CardName="cardName",e.CardNumber="cardNumber",e.CardNumberVerification="cardNumberVerification",e.CardExpiryVerification="cardExpiryVerification"}(a||(a={}));const _=a;function I(e){return _.CardNumber in e}function C(e){return _.CardCodeVerification in e||_.CardNumberVerification in e}var P,O,E,k,M,x=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class A{constructor(e,t,n,i){this._scriptLoader=e,this._paymentIntegrationService=t,this._blueSnapDirectHostedForm=n,this._blueSnapDirect3ds=i}initialize(e){return x(this,void 0,void 0,(function*(){const{methodId:t,gatewayId:n,creditCard:i}=e;if(!n||!i)throw new y;const o=yield this._paymentIntegrationService.loadPaymentMethod(n,{params:{method:t,bigpayToken:i.bigpayToken}}),{config:{testMode:r,is3dsEnabled:a},clientToken:s}=o.getPaymentMethodOrThrow(t,n);this._blueSnapSdk=yield this._scriptLoader.load(r),this._paymentFieldsToken=s,this._shouldUseHostedFields=I(i.form.fields)||C(i.form.fields)&&!!i.form.fields.cardNumberVerification,this._shouldUseHostedFields&&(this._blueSnapDirectHostedForm.initialize(this._blueSnapSdk,i.form.fields),yield this._blueSnapDirectHostedForm.attach(this._getPaymentFieldsToken(),i,a))}))}execute(e){return x(this,void 0,void 0,(function*(){if(!e.payment)throw new g(["payment"]);if(!this._blueSnapSdk)throw new g(["payment"]);const{paymentData:t}=e.payment,{shouldSaveInstrument:n,shouldSetAsDefaultInstrument:i}=v(t)?t:{shouldSaveInstrument:!1,shouldSetAsDefaultInstrument:!1},o=this._getPaymentFieldsToken();let r;const{is3dsEnabled:a}=this._paymentIntegrationService.getState().getPaymentMethodOrThrow(e.payment.methodId,e.payment.gatewayId).config,s=this._shouldUseHostedFields?yield this._blueSnapDirectHostedForm.validate().submit(a?this._getBlueSnapDirectThreeDSecureData():void 0,!(v(t)&&b(t))):void 0;if(yield this._paymentIntegrationService.submitOrder(),v(t)&&b(t)&&this._paymentFieldsToken&&t.instrumentId){if(a){this._blueSnapDirect3ds.initialize(this._blueSnapSdk);const{last4:e,brand:n}=this._paymentIntegrationService.getState().getCardInstrumentOrThrow(t.instrumentId),i=Object.assign({last4Digits:e,ccType:n.toUpperCase()},this._getBlueSnapDirectThreeDSecureData());r=yield this._blueSnapDirect3ds.initialize3ds(this._paymentFieldsToken,i)}yield this._paymentIntegrationService.submitPayment(Object.assign(Object.assign({},e.payment),{paymentData:Object.assign(Object.assign(Object.assign({instrumentId:t.instrumentId},this._shouldUseHostedFields?{nonce:o}:{}),r?{deviceSessionId:r}:{}),{shouldSetAsDefaultInstrument:!!i})}))}else yield this._paymentIntegrationService.submitPayment(Object.assign(Object.assign({},e.payment),{paymentData:{formattedPayload:{credit_card_token:{token:JSON.stringify({pfToken:o,cardHolderName:s&&s.cardHolderName})},vault_payment_instrument:n,set_as_default_stored_instrument:i}}}))}))}finalize(){return Promise.reject(new w)}deinitialize(){return this._shouldUseHostedFields&&this._blueSnapDirectHostedForm.detach(),Promise.resolve()}_getBlueSnapDirectThreeDSecureData(){var e;const{getBillingAddress:t,getShippingAddress:n,getCustomer:i,getCheckoutOrThrow:o,getCartOrThrow:r}=this._paymentIntegrationService.getState(),a=t(),s=n(),d=(null===(e=i())||void 0===e?void 0:e.email)||(null==a?void 0:a.email),c=(null==a?void 0:a.phone)||(null==s?void 0:s.phone);return Object.assign(Object.assign(Object.assign(Object.assign({amount:o().outstandingBalance,currency:r().currency.code},d&&{email:d}),c&&{phone:c}),a&&{billingFirstName:a.firstName,billingLastName:a.lastName,billingCountry:a.countryCode,billingCity:a.city,billingAddress:`${a.address1} ${a.address2}`.trim(),billingZip:a.postalCode}),s&&{shippingFirstName:s.firstName,shippingLastName:s.lastName,shippingCountry:s.countryCode,shippingCity:s.city,shippingAddress:`${s.address1} ${s.address2}`.trim(),shippingZip:s.postalCode})}_getPaymentFieldsToken(){return h(this._paymentFieldsToken,(()=>new S(r.MissingPaymentToken)))}}class N extends l{constructor(e,t){super(t||"Unable to proceed because the payment form contains invalid data."),this.details=e,this.name="PaymentInvalidFormError",this.type="payment_invalid_form"}}!function(e){e.AMEX="american-express",e.CHINA_UNION_PAY="unionpay",e.DINERS="diners-club",e.DISCOVER="discover",e.JCB="jcb",e.MASTERCARD="mastercard",e.UNKNOWN="unknown",e.VISA="visa"}(P||(P={})),function(e){e.ON_BLUR="onBlur",e.ON_SUBMIT="onSubmit"}(O||(O={})),function(e){e.EMPTY="empty",e.INVALID="invalid",e.THREE_DS_NOT_ENABLED="3D Secure is not enabled"}(E||(E={})),function(e){e.CC_NOT_SUPORTED="22013",e.ERROR_403="403",e.ERROR_404="404",e.ERROR_500="500",e.INVALID_OR_EMPTY="10",e.SESSION_EXPIRED="400",e.THREE_DS_AUTH_FAILED="14101",e.THREE_DS_CLIENT_ERROR="14103",e.THREE_DS_MISSING_FIELDS="14102",e.THREE_DS_NOT_ENABLED="14100",e.TOKEN_EXPIRED="14040",e.TOKEN_NOT_ASSOCIATED="14042",e.TOKEN_NOT_FOUND="14041"}(k||(k={})),function(e){e.CardCode="cvv",e.CardExpiry="exp",e.CardName="noc",e.CardNumber="ccn"}(M||(M={}));const T={[M.CardNumber]:_.CardNumber,[M.CardExpiry]:_.CardExpiry,[M.CardName]:_.CardName,[M.CardCode]:_.CardCode},D={empty:{[_.CardNumber]:{fieldType:"cardNumber",message:"Credit card number is required",type:"required"},[_.CardNumberVerification]:{fieldType:"cardNumber",message:"Credit card number is required",type:"required"},[_.CardExpiry]:{fieldType:"cardExpiry",message:"Expiration date is required",type:"required"},[_.CardCode]:{fieldType:"cardCode",message:"CVV is required",type:"required"},[_.CardName]:{fieldType:"cardName",message:"Full name is required",type:"required"}},invalid:{[_.CardNumber]:{fieldType:"cardNumber",message:"Credit card number must be valid",type:"invalid_card_number"},[_.CardNumberVerification]:{fieldType:"cardNumber",message:"Credit card number must be valid",type:"invalid_card_number"},[_.CardExpiry]:{fieldType:"cardExpiry",message:"Expiration date must be a valid future date in MM / YY format",type:"invalid_card_expiry"},[_.CardCode]:{fieldType:"cardCode",message:"CVV must be valid",type:"invalid_card_code"},[_.CardName]:{fieldType:"cardName",message:"Full name is required",type:"required"}}};class z{constructor(e,t){this._nameOnCardInput=e,this._hostedInputValidator=t}initialize(e,t){this._blueSnapSdk=e,t&&(I(t)?this._hostedInputValidator.initialize():C(t)&&t.cardNumberVerification&&this._hostedInputValidator.initializeValidationFields())}attach(e,t,n){var i,o,r,a=t.form,{fields:s}=a,d=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(a,["fields"]);return void 0===n&&(n=!1),i=this,r=function*(){const t=this._getBlueSnapSdk();if(!I(s)&&!C(s))throw new y("Field options must be of type HostedCardFieldOptionsMap");return this._onValidate=d.onValidate,I(s)&&this._setCustomBlueSnapAttributes(s),C(s)&&this._setCustomStoredCardsBlueSnapAttributes(s),new Promise((i=>{const o=this._getHostedPaymentFieldsOptions(e,s,d,i,n);t.hostedPaymentFieldsCreate(o),I(s)&&this._nameOnCardInput.attach(o,s.cardName.accessibilityLabel,s.cardName.placeholder)}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{s(r.next(e))}catch(e){t(e)}}function a(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,a)}s((r=r.apply(i,[])).next())}))}validate(){var e;const t=this._hostedInputValidator.validate();if(null===(e=this._onValidate)||void 0===e||e.call(this,t),!t.isValid){const e=Object.entries(t.errors).reduce(((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:n.map((({message:e,type:t})=>({message:e,type:t})))})),{});throw new N(e)}return this}submit(e,t=!1){return new Promise(((n,i)=>this._getBlueSnapSdk().hostedPaymentFieldsSubmitData((e=>this._isBlueSnapDirectCallbackError(e)?i(new p(e.statusCode===k.THREE_DS_AUTH_FAILED?e.error[0].errorDescription:`Submission failed with status: ${e.statusCode} and errors: ${JSON.stringify(e.error)}`)):n(Object.assign(Object.assign({},e.cardData),t?{cardHolderName:this._nameOnCardInput.getValue()}:{}))),e)))}detach(){this._nameOnCardInput.detach()}_isBlueSnapDirectCallbackError(e){return"error"in e}_getHostedPaymentFieldsOptions(e,t,{onFocus:n,onBlur:i,onValidate:o,onCardTypeChange:r,onEnter:a,styles:s},d,c){var u;return Object.assign(Object.assign(Object.assign({token:e,onFieldEventHandler:{setupComplete:()=>d(),onFocus:this._usetUiEventCallback(n),onBlur:this._usetUiEventCallback(i),onError:this._handleError(o),onType:(e,t)=>null==r?void 0:r({cardType:P[t]}),onEnter:this._usetUiEventCallback(a),onValid:e=>null==o?void 0:o(this._hostedInputValidator.validate({tagId:e}))}},I(t)&&{ccnPlaceHolder:t.cardNumber.placeholder||"",cvvPlaceHolder:(null===(u=t.cardCode)||void 0===u?void 0:u.placeholder)||"",expPlaceHolder:t.cardExpiry.placeholder||"MM / YY"}),s&&{style:this._mapStyles(s)}),{"3DS":c})}_mapStyles({default:e,error:t,focus:n}){return Object.entries(Object.assign(Object.assign(Object.assign({},e&&{input:e}),t&&{".invalid":t}),n&&{":focus":n})).reduce(((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:Object.entries(n).reduce(((e,[t,n])=>Object.assign(Object.assign({},e),{[(0,d.kebabCase)(t)]:n})),{})})),{})}_handleError(e){return(t,n,i,o)=>{if(n===k.INVALID_OR_EMPTY&&t&&function(e){return void 0!==e&&[E.EMPTY,E.INVALID].includes(e)}(i))return null==e?void 0:e(this._hostedInputValidator.validate({tagId:t,errorDescription:i}));throw new p(`An unexpected error has occurred: ${JSON.stringify({tagId:t,errorCode:n,errorDescription:i,eventOrigin:o})}`)}}_usetUiEventCallback(e){return t=>{e&&e({fieldType:T[t]})}}_getBlueSnapSdk(){return h(this._blueSnapSdk,(()=>new m(i.PaymentNotInitialized)))}_setCustomBlueSnapAttributes(e){const{cardNumber:t,cardExpiry:n,cardCode:i,cardName:o}=e,r=document.getElementById(t.containerId),a=document.getElementById(n.containerId),s=i&&document.getElementById(i.containerId),d=document.getElementById(o.containerId);if(!(r&&a&&s&&d))throw new y("Unable to create hosted payment fields to invalid HTML container elements.");r.dataset.bluesnap=M.CardNumber,a.dataset.bluesnap=M.CardExpiry,s.dataset.bluesnap=M.CardCode,d.dataset.bluesnap=M.CardName}_setCustomStoredCardsBlueSnapAttributes(e){const{cardNumberVerification:t,cardCodeVerification:n}=e,i=t&&document.getElementById(t.containerId),o=n&&document.getElementById(n.containerId);(i||o)&&(i&&(i.dataset.bluesnap=M.CardNumber),o&&(o.dataset.bluesnap=M.CardCode))}}class B{constructor(){this._errors={}}initialize(){this._errors={cardNumber:[D.empty.cardNumber],cardExpiry:[D.empty.cardExpiry],cardCode:[D.empty.cardCode],cardName:[D.empty.cardName]}}initializeValidationFields(){this._errors={cardNumberVerification:[D.empty.cardNumber]}}validate(e){return e&&this._updateErrors(e.tagId,e.errorDescription),{isValid:Object.values(this._errors).every((e=>0===e.length)),errors:this._errors}}_updateErrors(e,t){const n=this._errors.cardNumberVerification?_.CardNumberVerification:T[e];this._errors[n]=t?[D[t][n]]:[]}}class L{attach({style:e,onFieldEventHandler:{onFocus:t,onBlur:n,onValid:i,onError:o,onEnter:r}={}},a,s){var d;this._style=e,this._create(),this._getInput().addEventListener("focus",this._handleFocus(t)),this._getInput().addEventListener("blur",this._handleBlur(n,i,o)),this._getInput().addEventListener("enter",this._handleEnter(r)),a&&this._getInput().setAttribute("aria-label",a),s&&(this._getInput().placeholder=s),null===(d=document.querySelector('[data-bluesnap="noc"]'))||void 0===d||d.appendChild(this._getInput())}getValue(){return this._getInput().value}detach(){this._input&&(this._input.remove(),this._input=void 0)}_handleFocus(e){return()=>{var t;this._applyStyles(null===(t=this._style)||void 0===t?void 0:t[":focus"]),null==e||e(M.CardName)}}_handleBlur(e,t,n){return({target:i})=>{var o,r;null==e||e(M.CardName),i instanceof HTMLInputElement&&(/\w{1,200}/.test(i.value)?(this._applyStyles(null===(o=this._style)||void 0===o?void 0:o.input),null==t||t(M.CardName)):(this._applyStyles(null===(r=this._style)||void 0===r?void 0:r[".invalid"]),null==n||n(M.CardName,k.INVALID_OR_EMPTY,E.EMPTY,O.ON_BLUR)))}}_handleEnter(e){return()=>null==e?void 0:e(M.CardName)}_applyStyles(e={}){const t={color:e.color,fontFamily:e["font-family"],fontSize:e["font-size"],fontWeight:e["font-weight"]},n=Object.keys(t);n.every((e=>["color","fontFamily","fontSize","fontWeight"].includes(e)))&&n.forEach((e=>{t[e]&&(this._getInput().style[e]=t[e]||"")}))}_configureInput(){this._getInput().autocomplete="cc-name",this._getInput().id=M.CardName,this._getInput().inputMode="text",this._getInput().maxLength=200,this._getInput().style.backgroundColor="transparent",this._getInput().style.border="0",this._getInput().style.height="100%",this._getInput().style.margin="0",this._getInput().style.outline="none",this._getInput().style.padding="0",this._getInput().style.width="100%",this._getInput().type="text"}_getInput(){return h(this._input,(()=>new m(i.PaymentNotInitialized)))}_create(){var e;this._input=document.createElement("input"),this._configureInput(),this._applyStyles(null===(e=this._style)||void 0===e?void 0:e.input)}}class j extends l{constructor(e){super(e||"Unable to proceed because the client library of a payment method is not loaded or ready to be used."),this.name="PaymentMethodClientUnavailableError",this.type="payment_method_client_unavailable"}}var R;!function(e){e.PRODUCTION="https://pay.bluesnap.com/web-sdk/5/bluesnap.js",e.SANDBOX="https://sandpay.bluesnap.com/web-sdk/5/bluesnap.js"}(R||(R={}));class U{constructor(e,t=window){this._scriptLoader=e,this._window=t}load(e=!1){return t=this,i=function*(){if(this._window.bluesnap)return this._window.bluesnap;if(yield this._scriptLoader.loadScript(e?R.SANDBOX:R.PRODUCTION),!this._window.bluesnap)throw new j;return this._window.bluesnap},new((n=void 0)||(n=Promise))((function(e,o){function r(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,a)}s((i=i.apply(t,[])).next())}));var t,n,i}}const V=u((e=>new A(new U((0,s.vQ)()),e,new z(new L,new B),new f)),[{id:"credit_card",gateway:"bluesnapdirect"}]);class F{constructor(e){this._paymentIntegrationService=e}execute(e){return t=this,i=function*(){const t=this._formatePaymentPayload(e);yield this._paymentIntegrationService.submitOrder();try{yield this._paymentIntegrationService.submitPayment(t)}catch(e){if(this._isBlueSnapDirectRedirectResponse(e)){const t=e.body.provider_data&&JSON.parse(e.body.provider_data);let n=e.body.additional_action_required.data.redirect_url;if(function(e){if("object"!=typeof e||null===e)return!1;const t=e;return!!t.merchantid&&"string"==typeof t.merchantid}(t)){const e=new URLSearchParams(t).toString();n=`${n}&${e}`}return new Promise((()=>window.location.replace(n)))}return Promise.reject(e)}},new((n=void 0)||(n=Promise))((function(e,o){function r(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,a)}s((i=i.apply(t,[])).next())}));var t,n,i}initialize(){return Promise.resolve()}finalize(){return Promise.reject(new w)}deinitialize(){return Promise.resolve()}_formatePaymentPayload({payment:e}){if(!e)throw new g(["payment"]);return e.paymentData&&b(e.paymentData)&&v(e.paymentData)?Object.assign(Object.assign({},e),{paymentData:{instrumentId:e.paymentData.instrumentId,shouldSetAsDefaultInstrument:!!e.paymentData.shouldSetAsDefaultInstrument}}):(t=e.paymentData,Boolean("object"==typeof t&&null!==t&&"accountNumber"in t&&"accountType"in t&&"shopperPermission"in t&&"routingNumber"in t)?Object.assign(Object.assign({},e),{paymentData:{formattedPayload:{ecp:Object.assign({account_number:e.paymentData.accountNumber,account_type:e.paymentData.accountType,shopper_permission:e.paymentData.shopperPermission,routing_number:e.paymentData.routingNumber},e.paymentData.companyName?{company_name:e.paymentData.companyName}:{}),vault_payment_instrument:e.paymentData.shouldSaveInstrument,set_as_default_stored_instrument:e.paymentData.shouldSetAsDefaultInstrument}}}):(n=e.paymentData,Boolean("object"==typeof n&&null!==n&&"iban"in n&&"firstName"in n&&"lastName"in n&&"shopperPermission"in n)?Object.assign(Object.assign({},e),{paymentData:{formattedPayload:{sepa_direct_debit:{iban:e.paymentData.iban,first_name:e.paymentData.firstName,last_name:e.paymentData.lastName,shopper_permission:e.paymentData.shopperPermission},vault_payment_instrument:e.paymentData.shouldSaveInstrument,set_as_default_stored_instrument:e.paymentData.shouldSetAsDefaultInstrument}}}):function(e){return Boolean("object"==typeof e&&null!==e&&"bic"in e)}(e.paymentData)?Object.assign(Object.assign({},e),{paymentData:{formattedPayload:{ideal:{bic:e.paymentData.bic}}}}):function(e){return Boolean("object"==typeof e&&null!==e&&"iban"in e&&!("firstName"in e)&&!("lastName"in e)&&!("shopperPermission"in e))}(e.paymentData)?Object.assign(Object.assign({},e),{paymentData:{formattedPayload:{pay_by_bank:{iban:e.paymentData.iban}}}}):{methodId:e.methodId}));var t,n}_isBlueSnapDirectRedirectResponse(e){var t;if("object"!=typeof e||null===e)return!1;const n=e;if(!n.body)return!1;const i=n.body;return"additional_action_required"===i.status&&!!(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.redirect_url)}}const H=u((e=>new F(e)),[{gateway:"bluesnapdirect"}]);class q{constructor(e){const t=new Promise(((e,t)=>{this.cancel=t}));this.promise=Promise.race([e,t])}}class W extends l{constructor(e){super(e||"Payment process was cancelled."),this.name="PaymentMethodCancelledError",this.type="payment_cancelled"}}var K;!function(e){e.ACKNOWLEDGE="ACKNOWLEDGE",e.FINALIZE="FINALIZE",e.INITIALIZE="INITIALIZE"}(K||(K={}));const $=K;var G=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class Y{constructor(e){this._paymentIntegrationService=e}execute(e,t){return G(this,void 0,void 0,(function*(){const{payment:n}=e;if(!n)throw new g(["payment"]);if(!this._initializeOptions)throw new m(i.PaymentNotInitialized);const{onLoad:o,style:r}=this._initializeOptions,a=this._createIframe("bluesnapv2_hosted_payment_page",r),s=new q(new Promise(d.noop));o(a,(()=>s.cancel(new W))),yield this._paymentIntegrationService.submitOrder(e,t),yield this._paymentIntegrationService.initializeOffsitePayment({methodId:n.methodId,gatewayId:n.gatewayId,shouldSaveInstrument:!1,target:a.name,promise:s.promise})}))}finalize(e){return G(this,void 0,void 0,(function*(){const t=this._paymentIntegrationService.getState(),n=t.getOrder(),i=t.getPaymentStatus();if(!n||i!==$.ACKNOWLEDGE&&i!==$.FINALIZE)return Promise.reject(new w);yield this._paymentIntegrationService.finalizeOrder(e)}))}initialize(e){return G(this,void 0,void 0,(function*(){this._initializeOptions=e&&e.bluesnapv2,yield Promise.resolve()}))}deinitialize(){return Promise.resolve()}_createIframe(e,t){const n=document.createElement("iframe");if(n.setAttribute("sandbox","allow-top-navigation allow-scripts allow-forms allow-same-origin"),n.name=e,t){const{border:e,height:i,width:o}=t;n.style.border=null!=e?e:"",n.style.height=null!=i?i:"",n.style.width=null!=o?o:""}return n}}const X=u((e=>new Y(e)),[{gateway:"bluesnapv2"}])},21654:e=>{var t="undefined"!=typeof Element,n="function"==typeof Map,i="function"==typeof Set,o="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function r(e,a){if(e===a)return!0;if(e&&a&&"object"==typeof e&&"object"==typeof a){if(e.constructor!==a.constructor)return!1;var s,d,c,u;if(Array.isArray(e)){if((s=e.length)!=a.length)return!1;for(d=s;0!==d--;)if(!r(e[d],a[d]))return!1;return!0}if(n&&e instanceof Map&&a instanceof Map){if(e.size!==a.size)return!1;for(u=e.entries();!(d=u.next()).done;)if(!a.has(d.value[0]))return!1;for(u=e.entries();!(d=u.next()).done;)if(!r(d.value[1],a.get(d.value[0])))return!1;return!0}if(i&&e instanceof Set&&a instanceof Set){if(e.size!==a.size)return!1;for(u=e.entries();!(d=u.next()).done;)if(!a.has(d.value[0]))return!1;return!0}if(o&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(a)){if((s=e.length)!=a.length)return!1;for(d=s;0!==d--;)if(e[d]!==a[d])return!1;return!0}if(e.constructor===RegExp)return e.source===a.source&&e.flags===a.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof a.valueOf)return e.valueOf()===a.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof a.toString)return e.toString()===a.toString();if((s=(c=Object.keys(e)).length)!==Object.keys(a).length)return!1;for(d=s;0!==d--;)if(!Object.prototype.hasOwnProperty.call(a,c[d]))return!1;if(t&&e instanceof Element)return!1;for(d=s;0!==d--;)if(("_owner"!==c[d]&&"__v"!==c[d]&&"__o"!==c[d]||!e.$$typeof)&&!r(e[c[d]],a[c[d]]))return!1;return!0}return e!=e&&a!=a}e.exports=function(e,t){try{return r(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},30183:(e,t,n)=>{"use strict";n.d(t,{cz:()=>T,mg:()=>L});var i,o,r,a=n(80315),s=n(69440),d=n(51077);class c extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}(r=i||(i={}))[r.MissingBillingAddress=0]="MissingBillingAddress",r[r.MissingCart=1]="MissingCart",r[r.MissingCheckout=2]="MissingCheckout",r[r.MissingConsignments=3]="MissingConsignments",r[r.MissingCustomer=4]="MissingCustomer",r[r.MissingCheckoutConfig=5]="MissingCheckoutConfig",r[r.MissingOrder=6]="MissingOrder",r[r.MissingOrderConfig=7]="MissingOrderConfig",r[r.MissingOrderId=8]="MissingOrderId",r[r.MissingPayment=9]="MissingPayment",r[r.MissingPaymentId=10]="MissingPaymentId",r[r.MissingPaymentInstrument=11]="MissingPaymentInstrument",r[r.MissingPaymentMethod=12]="MissingPaymentMethod",r[r.MissingPaymentRedirectUrl=13]="MissingPaymentRedirectUrl",r[r.MissingPaymentStatus=14]="MissingPaymentStatus",r[r.MissingPaymentToken=15]="MissingPaymentToken",r[r.MissingShippingAddress=16]="MissingShippingAddress";class u extends c{constructor(e){super(function(e){switch(e){case i.MissingBillingAddress:return"Unable to proceed because billing address data is unavailable.";case i.MissingCart:return"Unable to proceed because cart data is unavailable.";case i.MissingConsignments:return"Unable to proceed because consignments data is unavailable.";case i.MissingCheckout:return"Unable to proceed because checkout data is unavailable.";case i.MissingCustomer:return"Unable to proceed because customer data is unavailable.";case i.MissingCheckoutConfig:case i.MissingOrderConfig:return"Unable to proceed because configuration data is unavailable.";case i.MissingOrder:return"Unable to proceed because order data is unavailable.";case i.MissingOrderId:return"Unable to proceed because order ID is unavailable or not generated yet.";case i.MissingPayment:return"Unable to proceed because payment data is unavailable.";case i.MissingPaymentToken:return"Unable to proceed because the token required to submit a payment is missing.";case i.MissingPaymentMethod:return"Unable to proceed because payment method data is unavailable or not properly configured.";case i.MissingShippingAddress:return"Unable to proceed because shipping address data is unavailable.";default:return"Unable to proceed because the required data is unavailable."}}(e)),this.subtype=e,this.name="MissingDataError",this.type="missing_data"}}function l(e){return t=e.lineItems.physicalItems.filter((e=>!e.addedByPromotion)),(0,s.reduce)(t,((e,t)=>e+t.quantity),0);var t}function p(e,t){if(null==e)throw t?t():new Error("An unexpected error has occurred.");return e}!function(e){e[e.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",e[e.CustomerNotInitialized=1]="CustomerNotInitialized",e[e.PaymentNotInitialized=2]="PaymentNotInitialized",e[e.ShippingNotInitialized=3]="ShippingNotInitialized",e[e.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized"}(o||(o={}));class h extends c{constructor(e){super(function(e){switch(e){case o.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case o.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case o.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case o.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(e)),this.subtype=e,this.name="NotInitializedError",this.type="not_initialized"}}const m={de:"eu",jp:"fe",uk:"eu",us:"na"};var f,y,g,v,b,w;!function(e){e.en_US="en_US",e.en_GB="en_GB",e.de_DE="de_DE",e.fr_FR="fr_FR",e.it_IT="it_IT",e.es_ES="es_ES",e.ja_JP="ja_JP"}(f||(f={})),function(e){e.Home="Home",e.Product="Product",e.Cart="Cart",e.Checkout="Checkout",e.Other="Other"}(y||(y={})),function(e){e.USD="USD",e.EUR="EUR",e.GBP="GBP",e.JPY="JPY"}(g||(g={})),function(e){e.PayAndShip="PayAndShip",e.PayOnly="PayOnly"}(v||(v={})),function(e){e.Gold="Gold",e.LightGray="LightGray",e.DarkGray="DarkGray"}(b||(b={})),function(e){e.C0001="C0001"}(w||(w={}));var S=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class _{constructor(e){this.amazonPayV2ScriptLoader=e}initialize(e){return S(this,void 0,void 0,(function*(){this.amazonPayV2SDK=yield this.amazonPayV2ScriptLoader.load(e),this.buttonParentContainer=this.buttonParentContainer||this.createAmazonPayButtonParentContainer()}))}deinitialize(){var e;return this.amazonPayV2Button=void 0,null===(e=this.buttonParentContainer)||void 0===e||e.remove(),this.buttonParentContainer=void 0,this.amazonPayV2SDK=void 0,Promise.resolve()}bindButton(e,t,n){this.getAmazonPayV2SDK().Pay.bindChangeAction(`#${e}`,{amazonCheckoutSessionId:t,changeAction:n})}createButton(e,t){this.amazonPayV2Button=this.getAmazonPayV2SDK().Pay.renderButton(`#${e}`,t)}prepareCheckout(e){const t=this.prepareRequestConfig(e);this.getAmazonPayV2Button().onClick((()=>{this.getAmazonPayV2Button().initCheckout(t)}))}prepareCheckoutWithCreationRequestConfig(e){this.getAmazonPayV2Button().onClick((()=>S(this,void 0,void 0,(function*(){const t=yield e();if(t){const e=this.prepareRequestConfig(t.createCheckoutSessionConfig,t.estimatedOrderAmount,t.productType);this.getAmazonPayV2Button().initCheckout(e)}}))))}signout(){return S(this,void 0,void 0,(function*(){return this.amazonPayV2SDK&&this.amazonPayV2SDK.Pay.signout(),Promise.resolve()}))}renderAmazonPayButton({buttonColor:e,checkoutState:t,containerId:n,decoupleCheckoutInitiation:i=!1,methodId:o,options:r,placement:a,isButtonMicroTextDisabled:s=!1}){const d=document.querySelector(`#${n}`);if(!d)return;const{id:c}=d.appendChild(this.getButtonParentContainer());r&&s&&(r.design=w.C0001);const u=null!=r?r:this.getAmazonPayV2ButtonOptions(t,o,a,i,e);return this.createButton(c,u),this.getButtonParentContainer()}updateBuyNowFlowFlag(e){this.isBuyNowFlow=Boolean(e)}isPh4Enabled(e,t){const n=!!e["PROJECT-3483.amazon_pay_ph4"],i=!!e["INT-6885.amazon_pay_ph4_us_only"];return n&&i?"US"===t:n}prepareRequestConfig(e,t,n){const{publicKeyId:i}=e,o=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(e,["publicKeyId"]);return Object.assign(Object.assign({createCheckoutSessionConfig:this.isEnvironmentSpecific(i)?o:e},t&&{estimatedOrderAmount:t}),n&&{productType:n})}createAmazonPayButtonParentContainer(){const e=Math.random().toString(16).substr(-4),t=document.createElement("div");return t.id=`amazonpay_button_parent_container_${e}`,t}getAmazonPayV2ButtonOptions(e,t,n,o=!1,r=b.Gold){var a;const{getCart:s,getCheckout:d,getStoreConfigOrThrow:c,getPaymentMethodOrThrow:p}=this.getCheckoutState(e),{config:{merchantId:h,testMode:m},initializationData:f}=p(t);if(!f)throw new u(i.MissingPaymentMethod);const{checkoutLanguage:y,checkoutSessionMethod:g,createCheckoutSessionConfig:S,extractAmazonCheckoutSessionId:_,ledgerCurrency:I,publicKeyId:C="",isButtonMicroTextDisabled:P}=f;if(!h||!I)throw new u(i.MissingPaymentMethod);const O=Object.assign({merchantId:h,ledgerCurrency:I,checkoutLanguage:y,placement:n,buttonColor:r},P?{design:w.C0001}:{});if(this.isBuyNowFlow)return Object.assign(Object.assign({},O),{sandbox:!!m});const E=s();O.productType=E&&0===l(E)?v.PayOnly:v.PayAndShip;const{checkoutSettings:{features:k},storeProfile:{shopPath:M,storeCountryCode:x}}=c();if(this.isPh4Enabled(k,x)){if(!S)throw new u(i.MissingPaymentMethod);const e=null===(a=d())||void 0===a?void 0:a.outstandingBalance.toString(),t=null==E?void 0:E.currency.code,n=Object.assign({},O);let r;return this.isEnvironmentSpecific(C)?(n.publicKeyId=C,r=S):(n.sandbox=!!m,r=Object.assign(Object.assign({},S),{publicKeyId:C})),o||(n.createCheckoutSessionConfig=r),e&&t&&(n.estimatedOrderAmount={amount:e,currencyCode:t}),n}const A={method:g,url:`${M}/remote-checkout/${t}/payment-session`,extractAmazonCheckoutSessionId:_};return Object.assign(Object.assign({},O),{createCheckoutSession:A,sandbox:!!m})}isEnvironmentSpecific(e){return/^(SANDBOX|LIVE)/.test(e)}getAmazonPayV2SDK(){return this.getOrThrow(this.amazonPayV2SDK)}getButtonParentContainer(){return this.getOrThrow(this.buttonParentContainer)}getAmazonPayV2Button(){return this.getOrThrow(this.amazonPayV2Button)}getOrThrow(e){return p(e,(()=>new h(o.PaymentNotInitialized)))}getCheckoutState(e){return"object"==typeof(t=e)&&null!==t&&"cart"in t&&"checkout"in t&&"config"in t&&"paymentMethods"in t?{getCart:e.cart.getCart,getCheckout:e.checkout.getCheckout,getStoreConfigOrThrow:e.config.getStoreConfigOrThrow,getPaymentMethodOrThrow:t=>e.paymentMethods.getPaymentMethodOrThrow(t)}:e;var t}}class I extends c{constructor(e){super(e||"Unable to proceed because the client library of a payment method is not loaded or ready to be used."),this.name="PaymentMethodClientUnavailableError",this.type="payment_method_client_unavailable"}}class C{constructor(e,t=window){this.scriptLoader=e,this.windowWithAmazonPay=t}load(e){return t=this,i=function*(){const{initializationData:t}=e,n=(null==t?void 0:t.region)||"us",i=m[n];if(yield this.scriptLoader.loadScript(`https://static-${i}.payments-amazon.com/checkout.js`),!this.windowWithAmazonPay.amazon)throw new I;return this.windowWithAmazonPay.amazon},new((n=void 0)||(n=Promise))((function(e,o){function r(e){try{s(i.next(e))}catch(e){o(e)}}function a(e){try{s(i.throw(e))}catch(e){o(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(r,a)}s((i=i.apply(t,[])).next())}));var t,n,i}}function P(){return new _(new C((0,a.vQ)()))}function O(e,t){return Object.assign(e,{resolveIds:t})}class E extends c{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class k extends E{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}class M extends c{constructor(e){super(e||"Payment process was cancelled."),this.name="PaymentMethodCancelledError",this.type="payment_cancelled"}}class x extends c{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}var A=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class N{constructor(e,t){this.paymentIntegrationService=e,this.amazonPayV2PaymentProcessor=t}initialize(e){return A(this,void 0,void 0,(function*(){const{methodId:t,amazonpay:n}=e;if(!t)throw new E('Unable to proceed because "methodId" argument is not provided.');const i=this.paymentIntegrationService.getState(),{features:o}=i.getStoreConfigOrThrow().checkoutSettings,r=i.getPaymentMethodOrThrow(t),a=r.initializationData||{},{paymentToken:s="",region:d="",isButtonMicroTextDisabled:c}=a;if(yield this.amazonPayV2PaymentProcessor.initialize(r),this._isReadyToPay(s))(null==n?void 0:n.editButtonId)&&this._bindEditButton(n.editButtonId,s,"changePayment",this._isModalFlow(d));else{const{id:e}=this._createContainer();if(this._amazonPayButton=this.amazonPayV2PaymentProcessor.renderAmazonPayButton({checkoutState:i,containerId:e,decoupleCheckoutInitiation:this._isOneTimeTransaction(o,d.toUpperCase()),methodId:t,placement:y.Checkout,isButtonMicroTextDisabled:c}),!this._amazonPayButton)throw new E("Unable to render the Amazon Pay button to an invalid HTML container element.")}}))}execute(e,t){return A(this,void 0,void 0,(function*(){const{payment:n}=e;if(!n)throw new k(["payment"]);const{methodId:i}=n,o=this.paymentIntegrationService.getState(),{features:r}=o.getStoreConfigOrThrow().checkoutSettings,a=o.getPaymentMethodOrThrow(i).initializationData||{},{paymentToken:d="",region:c=""}=a;if(this._isReadyToPay(d)||this._isOneTimeTransaction(r,c.toUpperCase())){const n={methodId:i,paymentData:{nonce:d||"apb"}};yield this.paymentIntegrationService.submitOrder(e,t);try{return void(yield this.paymentIntegrationService.submitPayment(n))}catch(e){if(!((e=>"object"==typeof e&&null!==e&&"body"in e)(e)&&(u=e.body,"object"==typeof u&&null!==u&&"status"in u&&"additional_action_required"in u&&"additional_action_required"===u.status&&"data"in u.additional_action_required&&"redirect_url"in u.additional_action_required.data&&"string"==typeof u.additional_action_required.data.redirect_url)))throw e;const{additional_action_required:t}=e.body,{redirect_url:n}=t.data;if(d)return new Promise((()=>window.location.assign(n)));this.amazonPayV2PaymentProcessor.prepareCheckout(JSON.parse(n))}}var u;return this._getAmazonPayButton().click(),this._isModalFlow(c)?new Promise(((e,t)=>{const n=()=>{window.removeEventListener("focus",n),t(new M("Shopper needs to login to Amazonpay to continue"))};window.addEventListener("focus",n)})):new Promise(s.noop)}))}finalize(){return Promise.reject(new x)}deinitialize(){return A(this,void 0,void 0,(function*(){yield this.amazonPayV2PaymentProcessor.deinitialize(),this._amazonPayButton=void 0}))}_bindEditButton(e,t,n,i){const o=document.getElementById(e);if(o&&o.parentNode){if(!i){const e=o.cloneNode(!0);o.parentNode.replaceChild(e,o),e.addEventListener("click",(()=>{this._showLoadingSpinner()}))}this.amazonPayV2PaymentProcessor.bindButton(e,t,n)}}_isModalFlow(e){return"us"===e}_showLoadingSpinner(){return A(this,void 0,void 0,(function*(){yield this.paymentIntegrationService.widgetInteraction((()=>new Promise(s.noop)))}))}_createContainer(){let e=document.getElementById("AmazonPayButton");return e||(e=document.createElement("div"),e.id="AmazonPayButton",e.style.display="none",document.body.appendChild(e))}_getAmazonPayButton(){return p(this._amazonPayButton,(()=>new h(o.PaymentNotInitialized)))}_isOneTimeTransaction(e,t){return this.amazonPayV2PaymentProcessor.isPh4Enabled(e,t)&&e["INT-6399.amazon_pay_apb"]}_isReadyToPay(e){return!!e}}const T=O((e=>new N(e,P())),[{id:"amazonpay"}]);class D extends c{constructor(e){super(e||"Not implemented."),this.name="NotImplementedError",this.type="not_implemented"}}var z=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class B{constructor(e,t){this.paymentIntegrationService=e,this.amazonPayV2PaymentProcessor=t}initialize(e){return z(this,void 0,void 0,(function*(){const{methodId:t,amazonpay:n}=e;if(!t||!(null==n?void 0:n.container))throw new E('Unable to proceed because "methodId" or "containerId" argument is not provided.');let i;try{i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)}catch(e){yield this.paymentIntegrationService.loadPaymentMethod(t),i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)}yield this.amazonPayV2PaymentProcessor.initialize(i),this.amazonPayV2PaymentProcessor.renderAmazonPayButton({checkoutState:this.paymentIntegrationService.getState(),containerId:n.container,methodId:t,placement:y.Checkout})}))}deinitialize(){return z(this,void 0,void 0,(function*(){yield this.amazonPayV2PaymentProcessor.deinitialize()}))}signIn(){throw new D('In order to sign in via Amazon, the shopper must click on "Amazon Pay" button.')}signOut(e){return z(this,void 0,void 0,(function*(){const t=this.paymentIntegrationService.getState().getPaymentId();t&&(yield this.amazonPayV2PaymentProcessor.signout(),yield this.paymentIntegrationService.remoteCheckoutSignOut(t.providerId,e))}))}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}}const L=O((e=>new B(e,P())),[{id:"amazonpay"}]);class j extends c{constructor(e){super(e||"An unexpected error has occurred during buy now cart creation process. Please try again later."),this.name="BuyNowCartCreationError",this.type="buy_now_cart_creation_error"}}class R extends c{constructor(e){super(e||"An unexpected error has occurred during config creation process. Please try again later."),this.name="AmazonPayV2ConfigCreationError",this.type="amazon_pay_v2_config_creation_error"}}function U(e){return e instanceof Object&&"buyNowInitializeOptions"in e}var V,F=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class H{constructor(e,t,n){this.paymentIntegrationService=e,this.amazonPayV2PaymentProcessor=t,this.amazonPayV2ConfigRequestSender=n}initialize(e){var t;return F(this,void 0,void 0,(function*(){const{methodId:n,containerId:i,amazonpay:o}=e,{buttonColor:r}=o||{};if(!n||!i)throw new E('Unable to proceed because "methodId" or "containerId" argument is not provided.');const{getPaymentMethodOrThrow:a}=this.paymentIntegrationService.getState(),s=a(n),{initializationData:d}=s;yield this.amazonPayV2PaymentProcessor.initialize(s),o||(yield this.paymentIntegrationService.loadDefaultCheckout());const c=U(o)?void 0:o;U(o)&&"function"==typeof(null===(t=o.buyNowInitializeOptions)||void 0===t?void 0:t.getBuyNowCartRequestBody)&&(this._buyNowInitializeOptions=o.buyNowInitializeOptions,this.amazonPayV2PaymentProcessor.updateBuyNowFlowFlag(!0)),this.amazonPayV2PaymentProcessor.renderAmazonPayButton({checkoutState:this.paymentIntegrationService.getState(),containerId:i,methodId:n,options:c,placement:y.Cart,buttonColor:r,isButtonMicroTextDisabled:null==d?void 0:d.isButtonMicroTextDisabled}),this._buyNowInitializeOptions&&this.amazonPayV2PaymentProcessor.prepareCheckoutWithCreationRequestConfig(this._getCheckoutCreationRequestConfig.bind(this))}))}deinitialize(){return this.amazonPayV2PaymentProcessor.deinitialize()}_createBuyNowCartOrThrow(){var e,t;return F(this,void 0,void 0,(function*(){const n=null===(t=null===(e=this._buyNowInitializeOptions)||void 0===e?void 0:e.getBuyNowCartRequestBody)||void 0===t?void 0:t.call(e);if(!n)throw new u(i.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(n)}catch(e){throw new j}}))}_createCheckoutConfig(e){return F(this,void 0,void 0,(function*(){try{const t=(yield this.amazonPayV2ConfigRequestSender.createCheckoutConfig(e)).body,{payload:n,public_key:i}=t,o=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(t,["payload","public_key"]);return Object.assign({payloadJSON:n,publicKeyId:i},o)}catch(e){throw new R}}))}_getCheckoutCreationRequestConfig(){return F(this,void 0,void 0,(function*(){const e=yield this._createBuyNowCartOrThrow(),t={amount:String(e.baseAmount),currencyCode:e.currency.code};return{createCheckoutSessionConfig:yield this._createCheckoutConfig(e.id),estimatedOrderAmount:t,productType:0===l(e)?v.PayOnly:v.PayAndShip}}))}}!function(e){e.Json="application/json",e.JsonV1="application/vnd.bc.v1+json"}(V||(V={}));const q=V,W={"X-Checkout-SDK-Version":"1.811.0"};class K{constructor(e){this._requestSender=e}createCheckoutConfig(e){const t={cartId:e},n=Object.assign({"X-API-INTERNAL":"This API endpoint is for internal use only and may change in the future","Content-Type":q.Json},W);return this._requestSender.post("/api/storefront/payment/amazonpay",{headers:n,body:t})}}O((e=>{const t=(0,d.createRequestSender)(),n=new K(t),i=P();return new H(e,i,n)}),[{id:"amazonpay"}])},32657:(e,t,n)=>{"use strict";n.d(t,{O:()=>d});var i=n(70355),o=n(36760),r=n.n(o),a=n(77175),s=n(41853);function d(e){var t=e.children,n=e.innerRef,o=i.useContext(a.$$),d=i.useCallback((function(e){(0,s.cZ)(n,e),(0,s.oV)(o,e)}),[n,o]);return i.useEffect((function(){return function(){return(0,s.cZ)(n,null)}}),[]),i.useEffect((function(){r()(Boolean(o),"`Reference` should not be used outside of a `Manager` component.")}),[o]),(0,s.vq)(t)({ref:d})}},36951:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>$});var i=n(84860),o=n(46141),r=n(35576),a=n(9938),s=n(72597),d=n.n(s),c=n(70355);n(40966);let u=e=>"object"==typeof e&&null!=e&&1===e.nodeType,l=(e,t)=>(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e,p=(e,t)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){let n=getComputedStyle(e,null);return l(n.overflowY,t)||l(n.overflowX,t)||(e=>{let t=(e=>{if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}})(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)})(e)}return!1},h=(e,t,n,i,o,r,a,s)=>r<e&&a>t||r>e&&a<t?0:r<=e&&s<=n||a>=t&&s>=n?r-e-i:a>t&&s<n||r<e&&s>n?a-t+o:0,m=e=>{let t=e.parentElement;return null==t?e.getRootNode().host||null:t};var f=n(31635),y=0;function g(e){return"function"==typeof e?e:v}function v(){}function b(e,t){if(e){var n=((e,t)=>{var n,i,o,r,a,s;if("undefined"==typeof document)return[];let{scrollMode:d,block:c,inline:l,boundary:f,skipOverflowHiddenElements:y}=t,g="function"==typeof f?f:e=>e!==f;if(!u(e))throw new TypeError("Invalid target");let v=document.scrollingElement||document.documentElement,b=[],w=e;for(;u(w)&&g(w);){if(w=m(w),w===v){b.push(w);break}null!=w&&w===document.body&&p(w)&&!p(document.documentElement)||null!=w&&p(w,y)&&b.push(w)}let S=null!=(i=null==(n=window.visualViewport)?void 0:n.width)?i:innerWidth,_=null!=(r=null==(o=window.visualViewport)?void 0:o.height)?r:innerHeight,I=null!=(a=window.scrollX)?a:pageXOffset,C=null!=(s=window.scrollY)?s:pageYOffset,{height:P,width:O,top:E,right:k,bottom:M,left:x}=e.getBoundingClientRect(),A="start"===c||"nearest"===c?E:"end"===c?M:E+P/2,N="center"===l?x+O/2:"end"===l?k:x,T=[];for(let e=0;e<b.length;e++){let t=b[e],{height:n,width:i,top:o,right:r,bottom:a,left:s}=t.getBoundingClientRect();if("if-needed"===d&&E>=0&&x>=0&&M<=_&&k<=S&&E>=o&&M<=a&&x>=s&&k<=r)return T;let u=getComputedStyle(t),p=parseInt(u.borderLeftWidth,10),m=parseInt(u.borderTopWidth,10),f=parseInt(u.borderRightWidth,10),y=parseInt(u.borderBottomWidth,10),g=0,w=0,D="offsetWidth"in t?t.offsetWidth-t.clientWidth-p-f:0,z="offsetHeight"in t?t.offsetHeight-t.clientHeight-m-y:0,B="offsetWidth"in t?0===t.offsetWidth?0:i/t.offsetWidth:0,L="offsetHeight"in t?0===t.offsetHeight?0:n/t.offsetHeight:0;if(v===t)g="start"===c?A:"end"===c?A-_:"nearest"===c?h(C,C+_,_,m,y,C+A,C+A+P,P):A-_/2,w="start"===l?N:"center"===l?N-S/2:"end"===l?N-S:h(I,I+S,S,p,f,I+N,I+N+O,O),g=Math.max(0,g+C),w=Math.max(0,w+I);else{g="start"===c?A-o-m:"end"===c?A-a+y+z:"nearest"===c?h(o,a,n,m,y+z,A,A+P,P):A-(o+n/2)+z/2,w="start"===l?N-s-p:"center"===l?N-(s+i/2)+D/2:"end"===l?N-r+f+D:h(s,r,i,p,f+D,N,N+O,O);let{scrollLeft:e,scrollTop:d}=t;g=Math.max(0,Math.min(d+g/L,t.scrollHeight-n/L+z)),w=Math.max(0,Math.min(e+w/B,t.scrollWidth-i/B+D)),A+=d-g,N+=e-w}T.push({el:t,top:g,left:w})}return T})(e,{boundary:t,block:"nearest",scrollMode:"if-needed"});n.forEach((function(e){var t=e.el,n=e.top,i=e.left;t.scrollTop=n,t.scrollLeft=i}))}}function w(e,t,n){return e===t||t instanceof n.Node&&e.contains&&e.contains(t)}function S(e,t){var n;function i(){n&&clearTimeout(n)}function o(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];i(),n=setTimeout((function(){n=null,e.apply(void 0,r)}),t)}return o.cancel=i,o}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.some((function(t){return t&&t.apply(void 0,[e].concat(i)),e.preventDownshiftDefault||e.hasOwnProperty("nativeEvent")&&e.nativeEvent.preventDownshiftDefault}))}}function I(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){"function"==typeof t?t(e):t&&(t.current=e)}))}}function C(){return String(y++)}function P(e){var t=e.isOpen,n=e.resultCount,i=e.previousResultCount;return t?n?n!==i?n+" result"+(1===n?" is":"s are")+" available, use up and down arrow keys to navigate. Press Enter key to select.":"":"No results are available.":""}function O(e,t){return!(e=Array.isArray(e)?e[0]:e)&&t?t:e}function E(e){return"string"==typeof e.type}function k(e){return e.props}var M=["highlightedIndex","inputValue","isOpen","selectedItem","type"];function x(e){void 0===e&&(e={});var t={};return M.forEach((function(n){e.hasOwnProperty(n)&&(t[n]=e[n])})),t}function A(e,t){return Object.keys(e).reduce((function(n,i){return n[i]=N(t,i)?t[i]:e[i],n}),{})}function N(e,t){return void 0!==e[t]}function T(e){var t=e.key,n=e.keyCode;return n>=37&&n<=40&&0!==t.indexOf("Arrow")?"Arrow"+t:t}function D(e,t,n,i,o){if(void 0===o&&(o=!0),0===n)return-1;var r=n-1;("number"!=typeof t||t<0||t>=n)&&(t=e>0?-1:r+1);var a=t+e;a<0?a=o?r:0:a>r&&(a=o?0:r);var s=z(e,a,n,i,o);return-1===s?t>=n?-1:t:s}function z(e,t,n,i,o){var r=i(t);if(!r||!r.hasAttribute("disabled"))return t;if(e>0){for(var a=t+1;a<n;a++)if(!i(a).hasAttribute("disabled"))return a}else for(var s=t-1;s>=0;s--)if(!i(s).hasAttribute("disabled"))return s;return o?e>0?z(1,0,n,i,!1):z(-1,n-1,n,i,!1):-1}function B(e,t,n,i){return void 0===i&&(i=!0),t.some((function(t){return t&&(w(t,e,n)||i&&w(t,n.document.activeElement,n))}))}var L=S((function(e){R(e).textContent=""}),500);function j(e,t){var n=R(t);e&&(n.textContent=e,L(t))}function R(e){void 0===e&&(e=document);var t=e.getElementById("a11y-status-message");return t||((t=e.createElement("div")).setAttribute("id","a11y-status-message"),t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-relevant","additions text"),Object.assign(t.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),e.body.appendChild(t),t)}var U=Object.freeze({__proto__:null,unknown:0,mouseUp:1,itemMouseEnter:2,keyDownArrowUp:3,keyDownArrowDown:4,keyDownEscape:5,keyDownEnter:6,keyDownHome:7,keyDownEnd:8,clickItem:9,blurInput:10,changeInput:11,keyDownSpaceButton:12,clickButton:13,blurButton:14,controlledPropUpdatedSelectedItem:15,touchEnd:16}),V=["refKey","ref"],F=["onClick","onPress","onKeyDown","onKeyUp","onBlur"],H=["onKeyDown","onBlur","onChange","onInput","onChangeText"],q=["refKey","ref"],W=["onMouseMove","onMouseDown","onClick","onPress","index","item"],K=function(){var e=function(e){function t(t){var n;(n=e.call(this,t)||this).id=n.props.id||"downshift-"+C(),n.menuId=n.props.menuId||n.id+"-menu",n.labelId=n.props.labelId||n.id+"-label",n.inputId=n.props.inputId||n.id+"-input",n.getItemId=n.props.getItemId||function(e){return n.id+"-item-"+e},n.input=null,n.items=[],n.itemCount=null,n.previousResultCount=0,n.timeoutIds=[],n.internalSetTimeout=function(e,t){var i=setTimeout((function(){n.timeoutIds=n.timeoutIds.filter((function(e){return e!==i})),e()}),t);n.timeoutIds.push(i)},n.setItemCount=function(e){n.itemCount=e},n.unsetItemCount=function(){n.itemCount=null},n.setHighlightedIndex=function(e,t){void 0===e&&(e=n.props.defaultHighlightedIndex),void 0===t&&(t={}),t=x(t),n.internalSetState((0,o.A)({highlightedIndex:e},t))},n.clearSelection=function(e){n.internalSetState({selectedItem:null,inputValue:"",highlightedIndex:n.props.defaultHighlightedIndex,isOpen:n.props.defaultIsOpen},e)},n.selectItem=function(e,t,i){t=x(t),n.internalSetState((0,o.A)({isOpen:n.props.defaultIsOpen,highlightedIndex:n.props.defaultHighlightedIndex,selectedItem:e,inputValue:n.props.itemToString(e)},t),i)},n.selectItemAtIndex=function(e,t,i){var o=n.items[e];null!=o&&n.selectItem(o,t,i)},n.selectHighlightedItem=function(e,t){return n.selectItemAtIndex(n.getState().highlightedIndex,e,t)},n.internalSetState=function(e,t){var i,r,a={},s="function"==typeof e;return!s&&e.hasOwnProperty("inputValue")&&n.props.onInputValueChange(e.inputValue,(0,o.A)({},n.getStateAndHelpers(),e)),n.setState((function(t){t=n.getState(t);var d=s?e(t):e;d=n.props.stateReducer(t,d),i=d.hasOwnProperty("selectedItem");var c={};return i&&d.selectedItem!==t.selectedItem&&(r=d.selectedItem),d.type=d.type||0,Object.keys(d).forEach((function(e){t[e]!==d[e]&&(a[e]=d[e]),"type"!==e&&(d[e],N(n.props,e)||(c[e]=d[e]))})),s&&d.hasOwnProperty("inputValue")&&n.props.onInputValueChange(d.inputValue,(0,o.A)({},n.getStateAndHelpers(),d)),c}),(function(){g(t)(),Object.keys(a).length>1&&n.props.onStateChange(a,n.getStateAndHelpers()),i&&n.props.onSelect(e.selectedItem,n.getStateAndHelpers()),void 0!==r&&n.props.onChange(r,n.getStateAndHelpers()),n.props.onUserAction(a,n.getStateAndHelpers())}))},n.rootRef=function(e){return n._rootNode=e},n.getRootProps=function(e,t){var r,a=void 0===e?{}:e,s=a.refKey,d=void 0===s?"ref":s,c=a.ref,u=(0,i.A)(a,V),l=(void 0===t?{}:t).suppressRefError,p=void 0!==l&&l;n.getRootProps.called=!0,n.getRootProps.refKey=d,n.getRootProps.suppressRefError=p;var h=n.getState().isOpen;return(0,o.A)(((r={})[d]=I(c,n.rootRef),r.role="combobox",r["aria-expanded"]=h,r["aria-haspopup"]="listbox",r["aria-owns"]=h?n.menuId:null,r["aria-labelledby"]=n.labelId,r),u)},n.keyDownHandlers={ArrowDown:function(e){var t=this;if(e.preventDefault(),this.getState().isOpen){var n=e.shiftKey?5:1;this.moveHighlightedIndex(n,{type:4})}else this.internalSetState({isOpen:!0,type:4},(function(){var e=t.getItemCount();if(e>0){var n=D(1,t.getState().highlightedIndex,e,(function(e){return t.getItemNodeFromIndex(e)}));t.setHighlightedIndex(n,{type:4})}}))},ArrowUp:function(e){var t=this;if(e.preventDefault(),this.getState().isOpen){var n=e.shiftKey?-5:-1;this.moveHighlightedIndex(n,{type:3})}else this.internalSetState({isOpen:!0,type:3},(function(){var e=t.getItemCount();if(e>0){var n=D(-1,t.getState().highlightedIndex,e,(function(e){return t.getItemNodeFromIndex(e)}));t.setHighlightedIndex(n,{type:3})}}))},Enter:function(e){if(229!==e.which){var t=this.getState(),n=t.isOpen,i=t.highlightedIndex;if(n&&null!=i){e.preventDefault();var o=this.items[i],r=this.getItemNodeFromIndex(i);if(null==o||r&&r.hasAttribute("disabled"))return;this.selectHighlightedItem({type:6})}}},Escape:function(e){e.preventDefault(),this.reset((0,o.A)({type:5},!this.state.isOpen&&{selectedItem:null,inputValue:""}))}},n.buttonKeyDownHandlers=(0,o.A)({},n.keyDownHandlers,{" ":function(e){e.preventDefault(),this.toggleMenu({type:12})}}),n.inputKeyDownHandlers=(0,o.A)({},n.keyDownHandlers,{Home:function(e){var t=this,n=this.getState().isOpen;if(n){e.preventDefault();var i=this.getItemCount();if(!(i<=0)&&n){var o=z(1,0,i,(function(e){return t.getItemNodeFromIndex(e)}),!1);this.setHighlightedIndex(o,{type:7})}}},End:function(e){var t=this,n=this.getState().isOpen;if(n){e.preventDefault();var i=this.getItemCount();if(!(i<=0)&&n){var o=z(-1,i-1,i,(function(e){return t.getItemNodeFromIndex(e)}),!1);this.setHighlightedIndex(o,{type:8})}}}}),n.getToggleButtonProps=function(e){var t=void 0===e?{}:e,r=t.onClick;t.onPress;var a=t.onKeyDown,s=t.onKeyUp,d=t.onBlur,c=(0,i.A)(t,F),u=n.getState().isOpen,l={onClick:_(r,n.buttonHandleClick),onKeyDown:_(a,n.buttonHandleKeyDown),onKeyUp:_(s,n.buttonHandleKeyUp),onBlur:_(d,n.buttonHandleBlur)},p=c.disabled?{}:l;return(0,o.A)({type:"button",role:"button","aria-label":u?"close menu":"open menu","aria-haspopup":!0,"data-toggle":!0},p,c)},n.buttonHandleKeyUp=function(e){e.preventDefault()},n.buttonHandleKeyDown=function(e){var t=T(e);n.buttonKeyDownHandlers[t]&&n.buttonKeyDownHandlers[t].call((0,r.A)(n),e)},n.buttonHandleClick=function(e){e.preventDefault(),n.props.environment.document.activeElement===n.props.environment.document.body&&e.target.focus(),n.internalSetTimeout((function(){return n.toggleMenu({type:13})}))},n.buttonHandleBlur=function(e){var t=e.target;n.internalSetTimeout((function(){n.isMouseDown||null!=n.props.environment.document.activeElement&&n.props.environment.document.activeElement.id===n.inputId||n.props.environment.document.activeElement===t||n.reset({type:14})}))},n.getLabelProps=function(e){return(0,o.A)({htmlFor:n.inputId,id:n.labelId},e)},n.getInputProps=function(e){var t=void 0===e?{}:e,r=t.onKeyDown,a=t.onBlur,s=t.onChange,d=t.onInput;t.onChangeText;var c=(0,i.A)(t,H),u={};var l,p=n.getState(),h=p.inputValue,m=p.isOpen,f=p.highlightedIndex;c.disabled||((l={}).onChange=_(s,d,n.inputHandleChange),l.onKeyDown=_(r,n.inputHandleKeyDown),l.onBlur=_(a,n.inputHandleBlur),u=l);return(0,o.A)({"aria-autocomplete":"list","aria-activedescendant":m&&"number"==typeof f&&f>=0?n.getItemId(f):null,"aria-controls":m?n.menuId:null,"aria-labelledby":c&&c["aria-label"]?void 0:n.labelId,autoComplete:"off",value:h,id:n.inputId},u,c)},n.inputHandleKeyDown=function(e){var t=T(e);t&&n.inputKeyDownHandlers[t]&&n.inputKeyDownHandlers[t].call((0,r.A)(n),e)},n.inputHandleChange=function(e){n.internalSetState({type:11,isOpen:!0,inputValue:e.target.value,highlightedIndex:n.props.defaultHighlightedIndex})},n.inputHandleBlur=function(){n.internalSetTimeout((function(){var e=n.props.environment.document&&!!n.props.environment.document.activeElement&&!!n.props.environment.document.activeElement.dataset&&n.props.environment.document.activeElement.dataset.toggle&&n._rootNode&&n._rootNode.contains(n.props.environment.document.activeElement);n.isMouseDown||e||n.reset({type:10})}))},n.menuRef=function(e){n._menuNode=e},n.getMenuProps=function(e,t){var r,a=void 0===e?{}:e,s=a.refKey,d=void 0===s?"ref":s,c=a.ref,u=(0,i.A)(a,q),l=(void 0===t?{}:t).suppressRefError,p=void 0!==l&&l;return n.getMenuProps.called=!0,n.getMenuProps.refKey=d,n.getMenuProps.suppressRefError=p,(0,o.A)(((r={})[d]=I(c,n.menuRef),r.role="listbox",r["aria-labelledby"]=u&&u["aria-label"]?null:n.labelId,r.id=n.menuId,r),u)},n.getItemProps=function(e){var t,r=void 0===e?{}:e,a=r.onMouseMove,s=r.onMouseDown,d=r.onClick;r.onPress;var c=r.index,u=r.item,l=void 0===u?void 0:u,p=(0,i.A)(r,W);void 0===c?(n.items.push(l),c=n.items.indexOf(l)):n.items[c]=l;var h=d,m=((t={onMouseMove:_(a,(function(){c!==n.getState().highlightedIndex&&(n.setHighlightedIndex(c,{type:2}),n.avoidScrolling=!0,n.internalSetTimeout((function(){return n.avoidScrolling=!1}),250))})),onMouseDown:_(s,(function(e){e.preventDefault()}))}).onClick=_(h,(function(){n.selectItemAtIndex(c,{type:9})})),t),f=p.disabled?{onMouseDown:m.onMouseDown}:m;return(0,o.A)({id:n.getItemId(c),role:"option","aria-selected":n.getState().highlightedIndex===c},f,p)},n.clearItems=function(){n.items=[]},n.reset=function(e,t){void 0===e&&(e={}),e=x(e),n.internalSetState((function(t){var i=t.selectedItem;return(0,o.A)({isOpen:n.props.defaultIsOpen,highlightedIndex:n.props.defaultHighlightedIndex,inputValue:n.props.itemToString(i)},e)}),t)},n.toggleMenu=function(e,t){void 0===e&&(e={}),e=x(e),n.internalSetState((function(t){var i=t.isOpen;return(0,o.A)({isOpen:!i},i&&{highlightedIndex:n.props.defaultHighlightedIndex},e)}),(function(){var i=n.getState(),o=i.isOpen,r=i.highlightedIndex;o&&n.getItemCount()>0&&"number"==typeof r&&n.setHighlightedIndex(r,e),g(t)()}))},n.openMenu=function(e){n.internalSetState({isOpen:!0},e)},n.closeMenu=function(e){n.internalSetState({isOpen:!1},e)},n.updateStatus=S((function(){var e=n.getState(),t=n.items[e.highlightedIndex],i=n.getItemCount(),r=n.props.getA11yStatusMessage((0,o.A)({itemToString:n.props.itemToString,previousResultCount:n.previousResultCount,resultCount:i,highlightedItem:t},e));n.previousResultCount=i,j(r,n.props.environment.document)}),200);var a=n.props,s=a.defaultHighlightedIndex,d=a.initialHighlightedIndex,c=void 0===d?s:d,u=a.defaultIsOpen,l=a.initialIsOpen,p=void 0===l?u:l,h=a.initialInputValue,m=void 0===h?"":h,f=a.initialSelectedItem,y=void 0===f?null:f,v=n.getState({highlightedIndex:c,isOpen:p,inputValue:m,selectedItem:y});return null!=v.selectedItem&&void 0===n.props.initialInputValue&&(v.inputValue=n.props.itemToString(v.selectedItem)),n.state=v,n}(0,a.A)(t,e);var n=t.prototype;return n.internalClearTimeouts=function(){this.timeoutIds.forEach((function(e){clearTimeout(e)})),this.timeoutIds=[]},n.getState=function(e){return void 0===e&&(e=this.state),A(e,this.props)},n.getItemCount=function(){var e=this.items.length;return null!=this.itemCount?e=this.itemCount:void 0!==this.props.itemCount&&(e=this.props.itemCount),e},n.getItemNodeFromIndex=function(e){return this.props.environment.document.getElementById(this.getItemId(e))},n.scrollHighlightedItemIntoView=function(){var e=this.getItemNodeFromIndex(this.getState().highlightedIndex);this.props.scrollIntoView(e,this._menuNode)},n.moveHighlightedIndex=function(e,t){var n=this,i=this.getItemCount(),o=this.getState().highlightedIndex;if(i>0){var r=D(e,o,i,(function(e){return n.getItemNodeFromIndex(e)}));this.setHighlightedIndex(r,t)}},n.getStateAndHelpers=function(){var e=this.getState(),t=e.highlightedIndex,n=e.inputValue,i=e.selectedItem,o=e.isOpen,r=this.props.itemToString,a=this.id,s=this.getRootProps,d=this.getToggleButtonProps,c=this.getLabelProps,u=this.getMenuProps,l=this.getInputProps,p=this.getItemProps,h=this.openMenu,m=this.closeMenu,f=this.toggleMenu,y=this.selectItem,g=this.selectItemAtIndex,v=this.selectHighlightedItem,b=this.setHighlightedIndex,w=this.clearSelection,S=this.clearItems;return{getRootProps:s,getToggleButtonProps:d,getLabelProps:c,getMenuProps:u,getInputProps:l,getItemProps:p,reset:this.reset,openMenu:h,closeMenu:m,toggleMenu:f,selectItem:y,selectItemAtIndex:g,selectHighlightedItem:v,setHighlightedIndex:b,clearSelection:w,clearItems:S,setItemCount:this.setItemCount,unsetItemCount:this.unsetItemCount,setState:this.internalSetState,itemToString:r,id:a,highlightedIndex:t,inputValue:n,isOpen:o,selectedItem:i}},n.componentDidMount=function(){var e=this;var t=function(){e.isMouseDown=!0},n=function(t){e.isMouseDown=!1,!B(t.target,[e._rootNode,e._menuNode],e.props.environment)&&e.getState().isOpen&&e.reset({type:1},(function(){return e.props.onOuterClick(e.getStateAndHelpers())}))},i=function(){e.isTouchMove=!1},o=function(){e.isTouchMove=!0},r=function(t){var n=B(t.target,[e._rootNode,e._menuNode],e.props.environment,!1);e.isTouchMove||n||!e.getState().isOpen||e.reset({type:16},(function(){return e.props.onOuterClick(e.getStateAndHelpers())}))},a=this.props.environment;a.addEventListener("mousedown",t),a.addEventListener("mouseup",n),a.addEventListener("touchstart",i),a.addEventListener("touchmove",o),a.addEventListener("touchend",r),this.cleanup=function(){e.internalClearTimeouts(),e.updateStatus.cancel(),a.removeEventListener("mousedown",t),a.removeEventListener("mouseup",n),a.removeEventListener("touchstart",i),a.removeEventListener("touchmove",o),a.removeEventListener("touchend",r)}},n.shouldScroll=function(e,t){var n=(void 0===this.props.highlightedIndex?this.getState():this.props).highlightedIndex,i=(void 0===t.highlightedIndex?e:t).highlightedIndex;return n&&this.getState().isOpen&&!e.isOpen||n!==i},n.componentDidUpdate=function(e,t){N(this.props,"selectedItem")&&this.props.selectedItemChanged(e.selectedItem,this.props.selectedItem)&&this.internalSetState({type:15,inputValue:this.props.itemToString(this.props.selectedItem)}),!this.avoidScrolling&&this.shouldScroll(t,e)&&this.scrollHighlightedItemIntoView(),this.updateStatus()},n.componentWillUnmount=function(){this.cleanup()},n.render=function(){var e=O(this.props.children,v);this.clearItems(),this.getRootProps.called=!1,this.getRootProps.refKey=void 0,this.getRootProps.suppressRefError=void 0,this.getMenuProps.called=!1,this.getMenuProps.refKey=void 0,this.getMenuProps.suppressRefError=void 0,this.getLabelProps.called=!1,this.getInputProps.called=!1;var t=O(e(this.getStateAndHelpers()));return t?this.getRootProps.called||this.props.suppressRefError?t:E(t)?(0,c.cloneElement)(t,this.getRootProps(k(t))):void 0:null},t}(c.Component);return e.defaultProps={defaultHighlightedIndex:null,defaultIsOpen:!1,getA11yStatusMessage:P,itemToString:function(e){return null==e?"":String(e)},onStateChange:v,onInputValueChange:v,onUserAction:v,onChange:v,onSelect:v,onOuterClick:v,selectedItemChanged:function(e,t){return e!==t},environment:"undefined"==typeof window?{}:window,stateReducer:function(e,t){return t},suppressRefError:!1,scrollIntoView:b},e.stateChangeTypes=U,e}(),$=K;S((function(e,t){j(e(),t)}),200),"undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?c.useLayoutEffect:c.useEffect;var G={itemToString:function(e){return e?String(e):""},stateReducer:function(e,t){return t.changes},getA11ySelectionMessage:function(e){var t=e.selectedItem,n=e.itemToString;return t?n(t)+" has been selected.":""},scrollIntoView:b,environment:"undefined"==typeof window?{}:window};d().array.isRequired,d().func,d().func,d().func,d().number,d().number,d().number,d().bool,d().bool,d().bool,d().any,d().any,d().any,d().string,d().string,d().string,d().func,d().string,d().func,d().func,d().func,d().func,d().func,d().shape({addEventListener:d().func,removeEventListener:d().func,document:d().shape({getElementById:d().func,activeElement:d().any,body:d().any})});(0,f.__assign)((0,f.__assign)({},G),{getA11yStatusMessage:function(e){var t=e.isOpen,n=e.resultCount,i=e.previousResultCount;return t?n?n!==i?"".concat(n," result").concat(1===n?" is":"s are"," available, use up and down arrow keys to navigate. Press Enter or Space Bar keys to select."):"":"No results are available.":""}});d().array.isRequired,d().func,d().func,d().func,d().func,d().number,d().number,d().number,d().bool,d().bool,d().bool,d().any,d().any,d().any,d().string,d().string,d().string,d().string,d().string,d().string,d().func,d().string,d().string,d().func,d().func,d().func,d().func,d().func,d().func,d().shape({addEventListener:d().func,removeEventListener:d().func,document:d().shape({getElementById:d().func,activeElement:d().any,body:d().any})});(0,o.A)({},G,{selectedItemChanged:function(e,t){return e!==t},getA11yStatusMessage:P});d().array,d().array,d().array,d().func,d().func,d().func,d().number,d().number,d().number,d().func,d().func,d().string,d().string,d().shape({addEventListener:d().func,removeEventListener:d().func,document:d().shape({getElementById:d().func,activeElement:d().any,body:d().any})})},40966:(e,t,n)=>{"use strict";n(56298)},41853:(e,t,n)=>{"use strict";n.d(t,{Es:()=>d,PW:()=>s,cZ:()=>a,oV:()=>r,vq:()=>o});var i=n(70355),o=function(e){return Array.isArray(e)?e[0]:e},r=function(e){if("function"==typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(void 0,n)}},a=function(e,t){if("function"==typeof e)return r(e,t);null!=e&&(e.current=t)},s=function(e){return e.reduce((function(e,t){var n=t[0],i=t[1];return e[n]=i,e}),{})},d="undefined"!=typeof window&&window.document&&window.document.createElement?i.useLayoutEffect:i.useEffect},56298:(e,t)=>{"use strict";var n=60103,i=60106,o=60107,r=60108,a=60114,s=60109,d=60110,c=60112,u=60113,l=60120,p=60115,h=60116,m=60121,f=60122,y=60117,g=60129,v=60131;
/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */if("function"==typeof Symbol&&Symbol.for){var b=Symbol.for;n=b("react.element"),i=b("react.portal"),o=b("react.fragment"),r=b("react.strict_mode"),a=b("react.profiler"),s=b("react.provider"),d=b("react.context"),c=b("react.forward_ref"),u=b("react.suspense"),l=b("react.suspense_list"),p=b("react.memo"),h=b("react.lazy"),m=b("react.block"),f=b("react.server.block"),y=b("react.fundamental"),g=b("react.debug_trace_mode"),v=b("react.legacy_hidden")}function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case a:case r:case u:case l:return e;default:switch(e=e&&e.$$typeof){case d:case c:case h:case p:case s:return e;default:return t}}case i:return t}}}},57068:(e,t,n)=>{"use strict";n.d(t,{p:()=>m});var i,o,r=n(69440);class a extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class s extends a{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class d extends a{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}class c extends s{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}(o=i||(i={}))[o.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",o[o.CustomerNotInitialized=1]="CustomerNotInitialized",o[o.PaymentNotInitialized=2]="PaymentNotInitialized",o[o.ShippingNotInitialized=3]="ShippingNotInitialized",o[o.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized";class u extends a{constructor(e){super(function(e){switch(e){case i.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case i.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case i.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case i.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(e)),this.subtype=e,this.name="NotInitializedError",this.type="not_initialized"}}var l=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))},p=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class h{constructor(e){this._paymentIntegrationService=e}execute(e,t){var n,i;return this._isHostedPaymentFormEnabled(null===(n=e.payment)||void 0===n?void 0:n.methodId,null===(i=e.payment)||void 0===i?void 0:i.gatewayId)&&this._shouldRenderHostedForm?this._executeWithHostedForm(e,t):this._executeWithoutHostedForm(e,t)}initialize(e){if(!this._isHostedPaymentFormEnabled(null==e?void 0:e.methodId,null==e?void 0:e.gatewayId)||!this._isHostedFieldAvailable(e))return this._shouldRenderHostedForm=!1,Promise.resolve();const t=e&&e.creditCard&&e.creditCard.form,n=this._paymentIntegrationService.getState(),{paymentSettings:{bigpayBaseUrl:i=""}={}}=n.getStoreConfigOrThrow();if(!t)throw new s;const o=this._paymentIntegrationService.createHostedForm(i,t);return o.attach().then((()=>(this._shouldRenderHostedForm=!0,this._hostedForm=o,Promise.resolve())))}deinitialize(){return this._hostedForm&&this._hostedForm.detach(),Promise.resolve()}finalize(){return Promise.reject(new d)}_executeWithoutHostedForm(e,t){return l(this,void 0,void 0,(function*(){const{payment:n}=e,i=p(e,["payment"]),o=n&&n.paymentData;if(!n||!o)throw new c(["payment.paymentData"]);yield this._paymentIntegrationService.submitOrder(i,t),yield this._paymentIntegrationService.submitPayment(Object.assign(Object.assign({},n),{paymentData:o}))}))}_executeWithHostedForm(e,t){return l(this,void 0,void 0,(function*(){const{payment:n}=e,o=p(e,["payment"]),r=this._hostedForm;if(!r)throw new u(i.PaymentNotInitialized);if(!n||!n.methodId)throw new c(["payment.methodId"]);yield this._paymentIntegrationService.submitOrder(o,t),yield r.validate().then((()=>r.submit(n)))}))}_isHostedPaymentFormEnabled(e,t){return!!e&&!0===this._paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t).config.isHostedFormEnabled}_isHostedFieldAvailable(e){return!(0,r.values)(e&&e.creditCard&&e.creditCard.form.fields).every(r.isNil)}}const m=(f=e=>new h(e),y=[{default:!0}],Object.assign(f,{resolveIds:y}));var f,y},73997:(e,t,n)=>{"use strict";n.d(t,{I8:()=>W,gg:()=>Z});var i=n(51077),o=n(80315),r=n(69440),a={};function s(e,t,n=!0){var i;return null!==(i=e[t])&&void 0!==i?i:n}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const d="3.128.0",c="3.123.2",u="3.106.0";class l{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(s(t,"PAYPAL-5809.braintree_hosted_fields_fix_version")?d:s(t,"PAYPAL-5636.update_braintree_sdk_version")?c:u)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const t=(0,r.find)(Object.values(e),(e=>!!e.VERSION));return null==t?void 0:t.VERSION}}}class p extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class h extends p{constructor(e){super(e||"Unsupported browser error"),this.name="UnsupportedBrowserError",this.type="unsupported_browser"}}var m,f,y,g,v,b,w,S,_;(_=m||(m={}))[_.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",_[_.CustomerNotInitialized=1]="CustomerNotInitialized",_[_.PaymentNotInitialized=2]="PaymentNotInitialized",_[_.ShippingNotInitialized=3]="ShippingNotInitialized",_[_.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized";class I extends p{constructor(e){super(function(e){switch(e){case m.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case m.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case m.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case m.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(e)),this.subtype=e,this.name="NotInitializedError",this.type="not_initialized"}}!function(e){e.ESTIMATED="ESTIMATED",e.FINAL="FINAL",e.NOT_CURRENTLY_KNOWN="NOT_CURRENTLY_KNOWN"}(f||(f={})),function(e){e.Completed="COMPLETED",e.Pending="PENDING",e.Failed="FAILED"}(y||(y={})),function(e){e.TRUSTLY="trustly"}(g||(g={})),function(e){e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="cancelled",e.UNRECOGNIZED="unrecognized"}(v||(v={})),function(e){e.Customer="CUSTOMER",e.Merchant="MERCHANT",e.Network="NETWORK",e.Internal="INTERNAL",e.Unknown="UNKNOWN"}(b||(b={})),function(e){e.KountNotEnabled="DATA_COLLECTOR_KOUNT_NOT_ENABLED"}(w||(w={})),function(e){e.Visa="visa",e.Mastercard="mastercard",e.AmericanExpress="american-express",e.DinersClub="diners-club",e.Discover="discover",e.Jcb="jcb",e.UnionPay="union-pay",e.Maestro="maestro",e.Elo="elo",e.Mir="mir",e.Hiper="hiper",e.Hipercard="hipercard"}(S||(S={}));var C,P,O,E=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class k{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return E(this,void 0,void 0,(function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0}))}getClient(){return E(this,void 0,void 0,(function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client}))}getDataCollectorOrThrow(e){return E(this,void 0,void 0,(function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),i=Object.assign({client:t,kount:!0},e);this.dataCollector=yield n.create(i)}catch(e){if(function(e){return Boolean("object"==typeof e&&null!==e&&("type"in e||"message"in e||"code"in e))}(e)&&e.code===w.KountNotEnabled)return t;throw e}return this.dataCollector}))}getBraintreeGooglePayment(){return E(this,void 0,void 0,(function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment}))}getBraintreeThreeDS(){return E(this,void 0,void 0,(function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS}))}getBraintreeLocalPayment(e){return E(this,void 0,void 0,(function*(){if(!this.braintreeLocalPayment){const[t,n]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise(((i,o)=>{n.create({client:t,merchantAccountId:e},((e,t)=>{e&&o(e),i(t)}))}))}return this.braintreeLocalPayment}))}getUsBankAccount(){return E(this,void 0,void 0,(function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount}))}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then((([e,t])=>t.create({client:e})))),this.visaCheckout}getVisaCheckoutSdk(e){return E(this,void 0,void 0,(function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK}))}getVenmoCheckoutOrThrow(){return E(this,void 0,void 0,(function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),n={client:e,allowDesktop:!0,paymentMethodUsage:"multi_use"},i=yield t.create(n);if(!i.isBrowserSupported())throw new h;this.braintreeVenmo=i}return this.braintreeVenmo}))}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new I(m.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}class M extends p{constructor(e){super(e||"Unable to proceed because the client library of a payment method is not loaded or ready to be used."),this.name="PaymentMethodClientUnavailableError",this.type="payment_method_client_unavailable"}}!function(e){e.Sandbox="sandbox",e.Production="production"}(C||(C={})),function(e){e.Client="client",e.DataCollector="dataCollector",e.Fastlane="fastlane",e.GooglePayment="googlePayment",e.HostedFields="hostedFields",e.LocalPayment="localPayment",e.Paypal="paypal",e.PaypalCheckout="paypalCheckout",e.ThreeDSecure="threeDSecure",e.UsBankAccount="usBankAccount",e.Venmo="venmo",e.VisaCheckout="visaCheckout"}(P||(P={})),function(e){e.CardCode="cardCode",e.CardCodeVerification="cardCodeVerification",e.CardExpiry="cardExpiry",e.CardName="cardName",e.CardNumber="cardNumber",e.CardNumberVerification="cardNumberVerification"}(O||(O={}));const x={[u]:{[P.Client]:"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt",[P.PaypalCheckout]:"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O",[P.Paypal]:"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+",[P.LocalPayment]:"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT",[P.DataCollector]:"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV",[P.UsBankAccount]:"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ",[P.GooglePayment]:"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe",[P.ThreeDSecure]:"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB",[P.VisaCheckout]:"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT",[P.Venmo]:"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov",[P.HostedFields]:"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy",[P.Fastlane]:"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa"},[c]:{[P.Client]:"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO",[P.PaypalCheckout]:"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/",[P.Paypal]:"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt",[P.LocalPayment]:"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH",[P.DataCollector]:"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO",[P.UsBankAccount]:"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW",[P.GooglePayment]:"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO",[P.ThreeDSecure]:"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym",[P.VisaCheckout]:"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS",[P.Venmo]:"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU",[P.HostedFields]:"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P",[P.Fastlane]:"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y"},[d]:{[P.Client]:"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq",[P.PaypalCheckout]:"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh",[P.Paypal]:"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH",[P.LocalPayment]:"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC",[P.DataCollector]:"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc",[P.UsBankAccount]:"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F",[P.GooglePayment]:"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i",[P.ThreeDSecure]:"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D",[P.VisaCheckout]:"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv",[P.Venmo]:"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz",[P.HostedFields]:"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z",[P.Fastlane]:"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr"}};var A,N=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};class T{constructor(e,t,n){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=n}loadClient(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.Client,"client.min.js")}))}loadFastlane(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.Fastlane,"fastlane.min.js")}))}loadPaypalCheckout(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.PaypalCheckout,"paypal-checkout.min.js")}))}loadPaypal(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.Paypal,"paypal.min.js")}))}loadLocalPayment(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.LocalPayment,"local-payment.min.js")}))}loadDataCollector(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.DataCollector,"data-collector.min.js")}))}loadUsBankAccount(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.UsBankAccount,"us-bank-account.min.js")}))}loadGooglePayment(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.GooglePayment,"google-payment.min.js")}))}load3DS(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.ThreeDSecure,"three-d-secure.min.js")}))}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(P.VisaCheckout,"visa-checkout.min.js")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(P.Venmo,"venmo.min.js")}loadHostedFields(){return N(this,void 0,void 0,(function*(){return this.loadBraintreeModuleOrThrow(P.HostedFields,"hosted-fields.min.js")}))}loadVisaCheckoutSdk(e){return N(this,void 0,void 0,(function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm":"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6";return this.scriptLoader.loadScript(`//${e?"sandbox-":""}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:"anonymous"}}).then((()=>{if(!this.braintreeHostWindow.V)throw new M;return this.braintreeHostWindow.V}))}))}loadBraintreeModuleOrThrow(e,t){return N(this,void 0,void 0,(function*(){let n=this.getBraintreeModule(e);if(n)return n;const i=this.braintreeSDKVersionManager.getSDKVersion(),o=`//js.braintreegateway.com/web/${i}/js/${t}`,r=i in x?this.getIntegrityValuesByModuleName(e,i):void 0;if(yield this.scriptLoader.loadScript(o,r?{async:!0,attributes:{integrity:r,crossorigin:"anonymous"}}:void 0),n=this.getBraintreeModule(e),!n)throw new M;return n}))}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const n=x[t][e];if(!n)throw new Error("Unexpected fileName value");return n}}function D(e,t){return Object.assign(e,{resolveIds:t})}class z extends p{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class B extends z{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}class L extends p{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}class j extends p{constructor(e){super(e||"Payment process was cancelled."),this.name="PaymentMethodCancelledError",this.type="payment_cancelled"}}!function(e){e.BRAINTREE="braintree",e.BRAINTREE_FASTLANE="braintreeacceleratedcheckout"}(A||(A={}));var R,U=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};!function(e){e.Shipping="Shipping",e.Subtotal="Subtotal",e.StoreCredit="Store Credit"}(R||(R={}));class V{constructor(e,t,n,i,o){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=n,this._braintreeSdk=i,this._applePayScriptLoader=o,this._shippingLabel=R.Shipping,this._subTotalLabel=R.Subtotal,this._storeCreditLabel=R.StoreCredit}initialize(e){var t,n,i,o;return U(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.methodId))throw new z('Unable to submit payment because "options.methodId" argument is not provided.');const{methodId:r}=e;yield this._applePayScriptLoader.loadSdk(),this._shippingLabel=(null===(t=e.applepay)||void 0===t?void 0:t.shippingLabel)||R.Shipping,this._subTotalLabel=(null===(n=e.applepay)||void 0===n?void 0:n.subtotalLabel)||R.Subtotal,this._storeCreditLabel=(null===(i=e.applepay)||void 0===i?void 0:i.storeCreditLabel)||R.StoreCredit;const a=(yield this._paymentIntegrationService.loadPaymentMethod(r)).getPaymentMethodOrThrow(r);(null===(o=a.initializationData)||void 0===o?void 0:o.gateway)===A.BRAINTREE&&(yield this._initializeBraintreeSdk())}))}execute(e,t){return U(this,void 0,void 0,(function*(){const{payment:n}=e,i=this._paymentIntegrationService.getState();if(!n)throw new B(["payment"]);const{methodId:o}=n,r=i.getPaymentMethodOrThrow(o),a=this._getBaseRequest(i,r),s=this._sessionFactory.create(a);return yield this._paymentIntegrationService.submitOrder({useStoreCredit:e.useStoreCredit},t),s.begin(),new Promise(((e,t)=>{this._handleApplePayEvents(s,r,{resolve:e,reject:t})}))}))}finalize(){return Promise.reject(new L)}deinitialize(){return Promise.resolve()}_getBaseRequest(e,t){const n=e.getCheckoutOrThrow(),i=e.getCartOrThrow(),o=e.getStoreConfigOrThrow(),{storeProfile:{storeCountryCode:r,storeName:a}}=o,{currency:{code:s,decimalPlaces:d}}=i,{initializationData:{merchantCapabilities:c,supportedNetworks:u}}=t,{grandTotal:l,isStoreCreditApplied:p,outstandingBalance:h}=n,m=[{label:this._subTotalLabel,amount:`${n.subtotal.toFixed(d)}`}];if(n.taxes.forEach((e=>m.push({label:e.name,amount:`${e.amount.toFixed(d)}`}))),m.push({label:this._shippingLabel,amount:`${n.shippingCostTotal.toFixed(d)}`}),p){const{storeCredit:t}=e.getCustomerOrThrow();m.push({label:this._storeCreditLabel,amount:`-${Math.min(l,t).toFixed(d)}`})}return{countryCode:r,currencyCode:s,merchantCapabilities:c,supportedNetworks:u,lineItems:m,total:{label:a,amount:`${h.toFixed(d)}`,type:"final"}}}_handleApplePayEvents(e,t,n){e.onvalidatemerchant=n=>U(this,void 0,void 0,(function*(){try{const{body:i}=yield this._onValidateMerchant(t,n);e.completeMerchantValidation(i)}catch(e){throw new Error("Merchant validation failed")}})),e.oncancel=()=>U(this,void 0,void 0,(function*(){return n.reject(new j("Continue with applepay"))})),e.onpaymentauthorized=i=>this._onPaymentAuthorized(i,e,t,n)}_onValidateMerchant(e,t){return U(this,void 0,void 0,(function*(){const n=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join("&");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded","X-XSRF-TOKEN":null},body:n})}))}_onPaymentAuthorized(e,t,n,i){var o;return U(this,void 0,void 0,(function*(){const{token:r}=e.payment;let a;(null===(o=n.initializationData)||void 0===o?void 0:o.gateway)===A.BRAINTREE&&(a=yield this._getBraintreeDeviceData());const s={methodId:n.id,paymentData:{deviceSessionId:a,formattedPayload:{apple_pay_token:{payment_data:r.paymentData,payment_method:r.paymentMethod,transaction_id:r.transactionIdentifier}}}};try{return yield this._paymentIntegrationService.submitPayment(s),t.completePayment(ApplePaySession.STATUS_SUCCESS),i.resolve()}catch(e){return t.completePayment(ApplePaySession.STATUS_FAILURE),i.reject(new I(m.PaymentNotInitialized))}}))}_getBraintreeDeviceData(){return U(this,void 0,void 0,(function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}}))}_initializeBraintreeSdk(){return U(this,void 0,void 0,(function*(){const e=this._paymentIntegrationService.getState();let t=e.getPaymentMethod(A.BRAINTREE_FASTLANE)||e.getPaymentMethod(A.BRAINTREE);t||(yield this._paymentIntegrationService.loadPaymentMethod(A.BRAINTREE),t=e.getPaymentMethod(A.BRAINTREE)),t&&t.clientToken&&t.initializationData&&this._braintreeSdk.initialize(t.clientToken)}))}}function F(e){if(!function(e){return"ApplePaySession"in e}(e))throw new Error("Apple pay is not supported")}class H{create(e){return F(window),new ApplePaySession(1,e)}}class q{constructor(e){this.scriptLoader=e,this.sdkVersion="1.latest"}loadSdk(){return e=this,n=function*(){yield this.scriptLoader.loadScript(`https://applepay.cdn-apple.com/jsapi/${this.sdkVersion}/apple-pay-sdk.js`),F(window)},new((t=void 0)||(t=Promise))((function(i,o){function r(e){try{s(n.next(e))}catch(e){o(e)}}function a(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,a)}s((n=n.apply(e,[])).next())}));var e,t,n}}const W=D((e=>{const{getHost:t}=e.getState(),n=new l(e);return new V((0,i.createRequestSender)({host:t()}),e,new H,new k(new T((0,o.vQ)(),window,n)),new q(new o.B2))}),[{id:"applepay"}]);var K;!function(e){e[e.MissingBillingAddress=0]="MissingBillingAddress",e[e.MissingCart=1]="MissingCart",e[e.MissingCheckout=2]="MissingCheckout",e[e.MissingConsignments=3]="MissingConsignments",e[e.MissingCustomer=4]="MissingCustomer",e[e.MissingCheckoutConfig=5]="MissingCheckoutConfig",e[e.MissingOrder=6]="MissingOrder",e[e.MissingOrderConfig=7]="MissingOrderConfig",e[e.MissingOrderId=8]="MissingOrderId",e[e.MissingPayment=9]="MissingPayment",e[e.MissingPaymentId=10]="MissingPaymentId",e[e.MissingPaymentInstrument=11]="MissingPaymentInstrument",e[e.MissingPaymentMethod=12]="MissingPaymentMethod",e[e.MissingPaymentRedirectUrl=13]="MissingPaymentRedirectUrl",e[e.MissingPaymentStatus=14]="MissingPaymentStatus",e[e.MissingPaymentToken=15]="MissingPaymentToken",e[e.MissingShippingAddress=16]="MissingShippingAddress"}(K||(K={}));class $ extends p{constructor(e){super(function(e){switch(e){case K.MissingBillingAddress:return"Unable to proceed because billing address data is unavailable.";case K.MissingCart:return"Unable to proceed because cart data is unavailable.";case K.MissingConsignments:return"Unable to proceed because consignments data is unavailable.";case K.MissingCheckout:return"Unable to proceed because checkout data is unavailable.";case K.MissingCustomer:return"Unable to proceed because customer data is unavailable.";case K.MissingCheckoutConfig:case K.MissingOrderConfig:return"Unable to proceed because configuration data is unavailable.";case K.MissingOrder:return"Unable to proceed because order data is unavailable.";case K.MissingOrderId:return"Unable to proceed because order ID is unavailable or not generated yet.";case K.MissingPayment:return"Unable to proceed because payment data is unavailable.";case K.MissingPaymentToken:return"Unable to proceed because the token required to submit a payment is missing.";case K.MissingPaymentMethod:return"Unable to proceed because payment method data is unavailable or not properly configured.";case K.MissingShippingAddress:return"Unable to proceed because shipping address data is unavailable.";default:return"Unable to proceed because the required data is unavailable."}}(e)),this.subtype=e,this.name="MissingDataError",this.type="missing_data"}}class G extends p{constructor(e){super(e||"Not implemented."),this.name="NotImplementedError",this.type="not_implemented"}}var Y,X=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};!function(e){e.Subtotal="Subtotal",e.Shipping="Shipping"}(Y||(Y={}));class J{constructor(e,t,n,i,o){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=n,this._braintreeSdk=i,this._applePayScriptLoader=o,this._onAuthorizeCallback=r.noop,this._onError=r.noop,this._onClick=r.noop,this._subTotalLabel=Y.Subtotal,this._shippingLabel=Y.Shipping,this._hasApplePaySession=!1}initialize(e){var t;return X(this,void 0,void 0,(function*(){const{methodId:n,applepay:i}=e;if(!n||!i)throw new $(K.MissingPaymentMethod);const{container:o,shippingLabel:a,subtotalLabel:s,onError:d=r.noop,onClick:c=r.noop,onPaymentAuthorize:u}=i;this._shippingLabel=a||Y.Shipping,this._subTotalLabel=s||Y.Subtotal,this._onAuthorizeCallback=u,this._onError=d,this._onClick=c;let l=this._paymentIntegrationService.getState();yield this._applePayScriptLoader.loadSdk();try{this._paymentMethod=l.getPaymentMethodOrThrow(n)}catch(e){l=yield this._paymentIntegrationService.loadPaymentMethod(n),this._paymentMethod=l.getPaymentMethodOrThrow(n)}yield this._paymentIntegrationService.verifyCheckoutSpamProtection(),this._applePayButton=this._createButton(o),this._applePayButton.addEventListener("click",this._handleWalletButtonClick.bind(this)),(null===(t=this._paymentMethod.initializationData)||void 0===t?void 0:t.gateway)===A.BRAINTREE&&(yield this._initializeBraintreeSdk())}))}deinitialize(){return Promise.resolve()}signIn(){throw new G('In order to sign in via Apple, the shopper must click on "Apple Pay" button.')}signOut(){throw new G("Need to do signout via apple.")}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}_createButton(e){const t=document.getElementById(e);if(!t)throw new z("Unable to create sign-in button without valid container ID.");const n=this._createApplePayButtonElement();return t.appendChild(n),n}_createApplePayButtonElement(){const e=document.createElement("apple-pay-button");return e.setAttribute("buttonstyle","black"),e.setAttribute("type","plain"),e.setAttribute("style","--apple-pay-button-width: 100%; --apple-pay-button-height: 36px; --apple-pay-button-border-radius: 4px;"),e}_handleWalletButtonClick(e){if(e.preventDefault(),this._hasApplePaySession)return;this._onClick();const t=this._paymentIntegrationService.getState(),n=t.getCartOrThrow(),i=t.getStoreConfigOrThrow(),o=t.getCheckoutOrThrow();if(!this._paymentMethod||!this._paymentMethod.initializationData)throw new $(K.MissingPaymentMethod);const r=this._getBaseRequest(n,o,i,this._paymentMethod),a=this._sessionFactory.create(r);this._handleApplePayEvents(a,this._paymentMethod,i),a.begin(),this._hasApplePaySession=!0}_getBaseRequest(e,t,n,i){var o;const{storeProfile:{storeCountryCode:r,storeName:a}}=n,{currency:{code:s,decimalPlaces:d}}=e,{initializationData:{merchantCapabilities:c,supportedNetworks:u}}=i,l=e.lineItems.physicalItems.length>0,p={requiredBillingContactFields:["postalAddress"],requiredShippingContactFields:["email","phone"],countryCode:r,currencyCode:s,merchantCapabilities:c,supportedNetworks:u,lineItems:[],total:l?{label:a,amount:`${t.grandTotal.toFixed(d)}`,type:"pending"}:{label:a,amount:`${t.grandTotal.toFixed(d)}`,type:"final"}};if(l)null===(o=p.requiredShippingContactFields)||void 0===o||o.push("postalAddress");else{const e=[{label:this._subTotalLabel,amount:`${t.subtotal.toFixed(d)}`}];t.taxes.forEach((t=>e.push({label:t.name,amount:`${t.amount.toFixed(d)}`}))),p.lineItems=e}return p}_handleApplePayEvents(e,t,n){e.onvalidatemerchant=n=>X(this,void 0,void 0,(function*(){try{const{body:i}=yield this._onValidateMerchant(t,n);e.completeMerchantValidation(i)}catch(e){this._onError(e)}})),e.onshippingcontactselected=t=>X(this,void 0,void 0,(function*(){return this._handleShippingContactSelected(e,n,t)})),e.onshippingmethodselected=t=>X(this,void 0,void 0,(function*(){return this._handleShippingMethodSelected(e,n,t)})),e.oncancel=()=>X(this,void 0,void 0,(function*(){this._hasApplePaySession=!1;try{const e=`/remote-checkout/${t.id}/signout`;return yield this._requestSender.get(e),yield this._paymentIntegrationService.loadCheckout()}catch(e){return this._onError(new j)}})),e.onpaymentauthorized=n=>X(this,void 0,void 0,(function*(){return this._onPaymentAuthorized(n,e,t)}))}_handleShippingContactSelected(e,t,n){var i;return X(this,void 0,void 0,(function*(){const o=this._transformContactToAddress(n.shippingContact);try{yield this._paymentIntegrationService.updateShippingAddress(o)}catch(t){return e.abort(),this._hasApplePaySession=!1,this._onError(t)}const{storeProfile:{storeName:r}}=t;let a=this._paymentIntegrationService.getState();const{currency:{decimalPlaces:s}}=a.getCartOrThrow();let d=a.getCheckoutOrThrow();const c=null===(i=d.consignments[0].selectedShippingOption)||void 0===i?void 0:i.id,u=d.consignments[0].availableShippingOptions,l=null==u?void 0:u.find((({id:e})=>e===c)),p=null==u?void 0:u.filter((e=>e.id!==c)),h=l?[{label:l.description,amount:`${l.cost.toFixed(s)}`,detail:l.additionalDescription,identifier:l.id}]:[];if(p&&[...p.filter((e=>e.isRecommended)),...p.filter((e=>!e.isRecommended))].forEach((e=>h.push({label:e.description,amount:`${e.cost.toFixed(s)}`,detail:e.additionalDescription,identifier:e.id}))),!(u instanceof Array))throw new Error("Shipping options not available.");if(0===u.length)return void e.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,[],{type:"pending",label:r,amount:`${d.grandTotal.toFixed(s)}`},[]);const m=u.find((e=>e.isRecommended)),f=m?m.id:u[0].id,y=l?l.id:f;try{yield this._updateShippingOption(y)}catch(e){return this._onError(e)}a=this._paymentIntegrationService.getState(),d=a.getCheckoutOrThrow(),e.completeShippingContactSelection({newShippingMethods:h,newTotal:{type:"final",label:r,amount:`${d.grandTotal.toFixed(s)}`},newLineItems:this._getUpdatedLineItems(d,s)})}))}_handleShippingMethodSelected(e,t,n){return X(this,void 0,void 0,(function*(){const{storeProfile:{storeName:i}}=t,{shippingMethod:{identifier:o}}=n;try{yield this._updateShippingOption(o)}catch(t){return e.abort(),this._hasApplePaySession=!1,this._onError(t)}const r=this._paymentIntegrationService.getState(),{currency:{decimalPlaces:a}}=r.getCartOrThrow(),s=r.getCheckoutOrThrow();e.completeShippingMethodSelection({newTotal:{type:"final",label:i,amount:`${s.grandTotal.toFixed(a)}`},newLineItems:this._getUpdatedLineItems(s,a)})}))}_getUpdatedLineItems(e,t){const n=[{label:this._subTotalLabel,amount:`${e.subtotal.toFixed(t)}`}];return e.taxes.forEach((e=>n.push({label:e.name,amount:`${e.amount.toFixed(t)}`}))),n.push({label:this._shippingLabel,amount:`${e.shippingCostTotal.toFixed(t)}`}),n}_updateShippingOption(e){return X(this,void 0,void 0,(function*(){return this._paymentIntegrationService.selectShippingOption(e)}))}_onValidateMerchant(e,t){return X(this,void 0,void 0,(function*(){const n=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join("&");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded","X-XSRF-TOKEN":null},body:n})}))}_onPaymentAuthorized(e,t,n){var i;return X(this,void 0,void 0,(function*(){const{token:o,billingContact:r,shippingContact:a}=e.payment,s=this._paymentIntegrationService.getState().getCartOrThrow().lineItems.physicalItems.length>0;let d;(null===(i=n.initializationData)||void 0===i?void 0:i.gateway)===A.BRAINTREE&&(d=yield this._getBraintreeDeviceData());const c={methodId:n.id,paymentData:{deviceSessionId:d,formattedPayload:{apple_pay_token:{payment_data:o.paymentData,payment_method:o.paymentMethod,transaction_id:o.transactionIdentifier}}}},u=this._transformContactToAddress(r),l=this._transformContactToAddress(a),p=null==a?void 0:a.emailAddress,h=(null==a?void 0:a.phoneNumber)||"";try{return yield this._paymentIntegrationService.updateBillingAddress(Object.assign(Object.assign({},u),{email:p,phone:h})),s&&(yield this._paymentIntegrationService.updateShippingAddress(l)),yield this._paymentIntegrationService.submitOrder({useStoreCredit:!1}),yield this._paymentIntegrationService.submitPayment(c),t.completePayment(ApplePaySession.STATUS_SUCCESS),this._onAuthorizeCallback()}catch(e){return t.completePayment(ApplePaySession.STATUS_FAILURE),this._onError(e)}}))}_transformContactToAddress(e){return{firstName:(null==e?void 0:e.givenName)||"",lastName:(null==e?void 0:e.familyName)||"",city:(null==e?void 0:e.locality)||"",company:"",address1:(null==e?void 0:e.addressLines)&&e.addressLines[0]||"",address2:(null==e?void 0:e.addressLines)&&e.addressLines[1]||"",postalCode:(null==e?void 0:e.postalCode)||"",countryCode:(null==e?void 0:e.countryCode)||"",phone:(null==e?void 0:e.phoneNumber)||"",stateOrProvince:(null==e?void 0:e.administrativeArea)||"",stateOrProvinceCode:(null==e?void 0:e.administrativeArea)||"",customFields:[]}}_getBraintreeDeviceData(){return X(this,void 0,void 0,(function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}}))}_initializeBraintreeSdk(){return X(this,void 0,void 0,(function*(){yield this._paymentIntegrationService.loadPaymentMethod(A.BRAINTREE);const e=this._paymentIntegrationService.getState().getPaymentMethod(A.BRAINTREE);e&&e.clientToken&&e.initializationData&&this._braintreeSdk.initialize(e.clientToken)}))}}const Z=D((e=>{const{getHost:t}=e.getState(),n=new l(e);return new J((0,i.createRequestSender)({host:t()}),e,new H,new k(new T((0,o.vQ)(),window,n)),new q(new o.B2))}),[{id:"applepay"}]);class Q extends p{constructor(e){super(e||"An unexpected error has occurred during buy now cart creation process. Please try again later."),this.name="BuyNowCartCreationError",this.type="buy_now_cart_creation_error"}}var ee,te,ne=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{d(i.next(e))}catch(e){r(e)}}function s(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((i=i.apply(e,t||[])).next())}))};!function(e){e.Subtotal="Subtotal",e.Shipping="Shipping"}(ee||(ee={})),function(e){e.Black="black",e.White="white",e.WhiteBorder="white-border"}(te||(te={}));class ie{constructor(e,t,n,i,o){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=n,this._braintreeSdk=i,this._applePayScriptLoader=o,this._onAuthorizeCallback=r.noop,this._subTotalLabel=ee.Subtotal,this._shippingLabel=ee.Shipping}initialize(e){var t,n;return ne(this,void 0,void 0,(function*(){const{methodId:i,containerId:o,applepay:r}=e;if(!i||!r)throw new $(K.MissingPaymentMethod);yield this._applePayScriptLoader.loadSdk();const{onPaymentAuthorize:a,buyNowInitializeOptions:s,requiresShipping:d}=r;this._requiresShipping=d,this._buyNowInitializeOptions=s,this._onAuthorizeCallback=a,s||(yield this._paymentIntegrationService.loadDefaultCheckout()),yield this._paymentIntegrationService.loadPaymentMethod(i);const c=this._paymentIntegrationService.getState();return this._paymentMethod=c.getPaymentMethodOrThrow(i),c.getCart()&&(yield this._paymentIntegrationService.verifyCheckoutSpamProtection()),(null===(t=this._paymentMethod.initializationData)||void 0===t?void 0:t.gateway)===A.BRAINTREE&&(yield this._initializeBraintreeSdk()),this._applePayButton=this._createButton(o,null===(n=this._paymentMethod.initializationData)||void 0===n?void 0:n.styleOption),this._applePayButton.addEventListener("click",this._handleWalletButtonClick.bind(this)),Promise.resolve()}))}deinitialize(){return Promise.resolve()}_createButton(e,t){const n=document.getElementById(e);if(!n)throw new z("Unable to create wallet button without valid container ID.");const i=this._createApplePayButtonElement(t);return n.appendChild(i),i}_createApplePayButtonElement(e){const t=document.createElement("apple-pay-button");return t.setAttribute("buttonstyle",(e=>{switch(e){case te.White:return"white";case te.WhiteBorder:return"white-outline";case te.Black:default:return"black"}})(e)),t.setAttribute("type","plain"),t.setAttribute("style","--apple-pay-button-width: 100%; --apple-pay-button-height: 40px; --apple-pay-button-border-radius: 4px;"),t}_handleWalletButtonClick(e){var t;return ne(this,void 0,void 0,(function*(){if(e.preventDefault(),!this._paymentMethod||!this._paymentMethod.initializationData)throw new $(K.MissingPaymentMethod);if(this._buyNowInitializeOptions&&"function"==typeof this._buyNowInitializeOptions.getBuyNowCartRequestBody){const{countryCode:e,currencyCode:n,merchantCapabilities:i,supportedNetworks:o,storeName:r}=this._paymentMethod.initializationData,a=this._getRequestWithEmptyTotal(e,n,o,i);this._requiresShipping&&(null===(t=a.requiredShippingContactFields)||void 0===t||t.push("postalAddress"));const s=this._sessionFactory.create(a);this._handleApplePayEvents(s,this._paymentMethod,r),s.begin()}else{const e=this._paymentIntegrationService.getState(),t=e.getCartOrThrow(),n=e.getStoreConfigOrThrow(),i=e.getCheckoutOrThrow(),o=this._getBaseRequest(t,i,n,this._paymentMethod),r=this._sessionFactory.create(o);this._handleApplePayEvents(r,this._paymentMethod,n.storeProfile.storeName),r.begin()}}))}_getRequestWithEmptyTotal(e,t,n,i){return{countryCode:e,currencyCode:t,supportedNetworks:n,merchantCapabilities:i,total:{label:"",amount:"0",type:"pending"},requiredBillingContactFields:["postalAddress"],requiredShippingContactFields:["email","phone"]}}_getBaseRequest(e,t,n,i){var o;const{storeProfile:{storeCountryCode:r,storeName:a}}=n,{currency:{code:s,decimalPlaces:d}}=e,{initializationData:{merchantCapabilities:c,supportedNetworks:u}}=i,l=e.lineItems.physicalItems.length>0,p={requiredBillingContactFields:["postalAddress"],requiredShippingContactFields:["email","phone"],countryCode:r,currencyCode:s,merchantCapabilities:c,supportedNetworks:u,lineItems:[],total:l?{label:a,amount:`${t.grandTotal.toFixed(d)}`,type:"pending"}:{label:a,amount:`${t.grandTotal.toFixed(d)}`,type:"final"}};if(l)null===(o=p.requiredShippingContactFields)||void 0===o||o.push("postalAddress");else{const e=[{label:this._subTotalLabel,amount:`${t.subtotal.toFixed(d)}`}];t.taxes.forEach((t=>e.push({label:t.name,amount:`${t.amount.toFixed(d)}`}))),p.lineItems=e}return p}_handleApplePayEvents(e,t,n){e.onvalidatemerchant=n=>ne(this,void 0,void 0,(function*(){try{const{body:i}=yield this._onValidateMerchant(t,n);e.completeMerchantValidation(i)}catch(e){throw new Error("Merchant validation failed")}})),this._buyNowInitializeOptions&&!this._requiresShipping&&(e.onpaymentmethodselected=()=>ne(this,void 0,void 0,(function*(){yield this._createBuyNowCart(),this._handlePaymentMethodSelected(e)}))),e.onshippingcontactselected=t=>ne(this,void 0,void 0,(function*(){this._buyNowInitializeOptions&&this._requiresShipping&&(yield this._createBuyNowCart()),yield this._handleShippingContactSelected(e,n,t)})),e.onshippingmethodselected=t=>ne(this,void 0,void 0,(function*(){yield this._handleShippingMethodSelected(e,n,t)})),e.oncancel=()=>ne(this,void 0,void 0,(function*(){try{const e=`/remote-checkout/${t.id}/signout`;return yield this._requestSender.get(e),yield this._paymentIntegrationService.loadCheckout()}catch(e){throw new j}})),e.onpaymentauthorized=n=>ne(this,void 0,void 0,(function*(){return this._onPaymentAuthorized(n,e,t)}))}_createBuyNowCart(){var e,t;return ne(this,void 0,void 0,(function*(){try{const n=null===(t=null===(e=this._buyNowInitializeOptions)||void 0===e?void 0:e.getBuyNowCartRequestBody)||void 0===t?void 0:t.call(e);if(!n)throw new $(K.MissingCart);const i=yield this._paymentIntegrationService.createBuyNowCart(n);yield this._paymentIntegrationService.loadCheckout(i.id);const o=this._paymentIntegrationService.getState(),{shouldExecuteSpamCheck:r}=o.getCheckoutOrThrow();r&&(yield this._paymentIntegrationService.verifyCheckoutSpamProtection())}catch(e){throw new Q}}))}_handlePaymentMethodSelected(e){const t=this._paymentIntegrationService.getState(),n=t.getCartOrThrow(),i=t.getStoreConfigOrThrow(),o=t.getCheckoutOrThrow();if(!this._paymentMethod||!this._paymentMethod.initializationData)throw new $(K.MissingPaymentMethod);const r=this._getBaseRequest(n,o,i,this._paymentMethod);delete r.total.type,e.completePaymentMethodSelection({newTotal:r.total,newLineItems:r.lineItems})}_handleShippingContactSelected(e,t,n){var i;return ne(this,void 0,void 0,(function*(){const o=this._transformContactToAddress(n.shippingContact);try{yield this._paymentIntegrationService.updateShippingAddress(o)}catch(t){throw e.abort(),new Error("Shipping address update failed")}let r=this._paymentIntegrationService.getState();const{currency:{decimalPlaces:a}}=r.getCartOrThrow();let s=r.getCheckoutOrThrow();const d=null===(i=s.consignments[0].selectedShippingOption)||void 0===i?void 0:i.id,c=s.consignments[0].availableShippingOptions,u=null==c?void 0:c.find((({id:e})=>e===d)),l=null==c?void 0:c.filter((e=>e.id!==d)),p=u?[{label:u.description,amount:`${u.cost.toFixed(a)}`,detail:u.additionalDescription,identifier:u.id}]:[];if(l&&[...l.filter((e=>e.isRecommended)),...l.filter((e=>!e.isRecommended))].forEach((e=>p.push({label:e.description,amount:`${e.cost.toFixed(a)}`,detail:e.additionalDescription,identifier:e.id}))),!(c instanceof Array))throw new Error("Shipping options not available.");if(0===c.length)return void e.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,[],{type:"pending",label:t,amount:`${s.grandTotal.toFixed(a)}`},[]);const h=c.find((e=>e.isRecommended)),m=h?h.id:c[0].id,f=u?u.id:m;try{yield this._updateShippingOption(f)}catch(e){throw new Error("Shipping options update failed")}r=this._paymentIntegrationService.getState(),s=r.getCheckoutOrThrow(),e.completeShippingContactSelection({newShippingMethods:p,newTotal:{type:"final",label:t,amount:`${s.grandTotal.toFixed(a)}`},newLineItems:this._getUpdatedLineItems(s,a)})}))}_handleShippingMethodSelected(e,t,n){return ne(this,void 0,void 0,(function*(){const{shippingMethod:{identifier:i}}=n;try{yield this._updateShippingOption(i)}catch(t){throw e.abort(),new Error("Shipping option selection update failed.")}const o=this._paymentIntegrationService.getState(),{currency:{decimalPlaces:r}}=o.getCartOrThrow(),a=o.getCheckoutOrThrow();e.completeShippingMethodSelection({newTotal:{type:"final",label:t,amount:`${a.grandTotal.toFixed(r)}`},newLineItems:this._getUpdatedLineItems(a,r)})}))}_getUpdatedLineItems(e,t){const n=[{label:this._subTotalLabel,amount:`${e.subtotal.toFixed(t)}`}];return e.taxes.forEach((e=>n.push({label:e.name,amount:`${e.amount.toFixed(t)}`}))),n.push({label:this._shippingLabel,amount:`${e.shippingCostTotal.toFixed(t)}`}),n}_updateShippingOption(e){return ne(this,void 0,void 0,(function*(){return this._paymentIntegrationService.selectShippingOption(e)}))}_onValidateMerchant(e,t){return ne(this,void 0,void 0,(function*(){const n=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join("&");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded","X-XSRF-TOKEN":null},body:n})}))}_onPaymentAuthorized(e,t,n){var i;return ne(this,void 0,void 0,(function*(){const{token:o,billingContact:r,shippingContact:a}=e.payment,s=this._paymentIntegrationService.getState().getCartOrThrow().lineItems.physicalItems.length>0;let d;(null===(i=n.initializationData)||void 0===i?void 0:i.gateway)===A.BRAINTREE&&(d=yield this._getBraintreeDeviceData());const c={methodId:n.id,paymentData:{deviceSessionId:d,formattedPayload:{apple_pay_token:{payment_data:o.paymentData,payment_method:o.paymentMethod,transaction_id:o.transactionIdentifier}}}},u=this._transformContactToAddress(r),l=this._transformContactToAddress(a),p=null==a?void 0:a.emailAddress,h=(null==a?void 0:a.phoneNumber)||"";try{return yield this._paymentIntegrationService.updateBillingAddress(Object.assign(Object.assign({},u),{email:p,phone:h})),s&&(yield this._paymentIntegrationService.updateShippingAddress(l)),yield this._paymentIntegrationService.submitOrder({useStoreCredit:!1}),yield this._paymentIntegrationService.submitPayment(c),t.completePayment(ApplePaySession.STATUS_SUCCESS),this._onAuthorizeCallback()}catch(e){throw t.completePayment(ApplePaySession.STATUS_FAILURE),new Error("Payment cannot complete")}}))}_transformContactToAddress(e){return{firstName:(null==e?void 0:e.givenName)||"",lastName:(null==e?void 0:e.familyName)||"",city:(null==e?void 0:e.locality)||"",company:"",address1:(null==e?void 0:e.addressLines)&&e.addressLines[0]||"",address2:(null==e?void 0:e.addressLines)&&e.addressLines[1]||"",postalCode:(null==e?void 0:e.postalCode)||"",countryCode:(null==e?void 0:e.countryCode)||"",phone:(null==e?void 0:e.phoneNumber)||"",stateOrProvince:(null==e?void 0:e.administrativeArea)||"",stateOrProvinceCode:(null==e?void 0:e.administrativeArea)||"",customFields:[]}}_getBraintreeDeviceData(){return ne(this,void 0,void 0,(function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}}))}_initializeBraintreeSdk(){return ne(this,void 0,void 0,(function*(){yield this._paymentIntegrationService.loadPaymentMethod(A.BRAINTREE);const e=this._paymentIntegrationService.getState().getPaymentMethod(A.BRAINTREE);e&&e.clientToken&&e.initializationData&&this._braintreeSdk.initialize(e.clientToken)}))}}D((e=>{const{getHost:t}=e.getState(),n=new l(e);return new ie((0,i.createRequestSender)({host:t()}),e,new H,new k(new T((0,o.vQ)(),window,n)),new q(new o.B2))}),[{id:"applepay"}])},75514:(e,t,n)=>{"use strict";n.d(t,{N:()=>Oe});var i=n(70355),o=n(77175),r=n(41853),a=n(54622);function s(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function d(e){return e instanceof s(e).Element||e instanceof Element}function c(e){return e instanceof s(e).HTMLElement||e instanceof HTMLElement}function u(e){return"undefined"!=typeof ShadowRoot&&(e instanceof s(e).ShadowRoot||e instanceof ShadowRoot)}var l=Math.max,p=Math.min,h=Math.round;function m(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function f(){return!/^((?!chrome|android).)*safari/i.test(m())}function y(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),o=1,r=1;t&&c(e)&&(o=e.offsetWidth>0&&h(i.width)/e.offsetWidth||1,r=e.offsetHeight>0&&h(i.height)/e.offsetHeight||1);var a=(d(e)?s(e):window).visualViewport,u=!f()&&n,l=(i.left+(u&&a?a.offsetLeft:0))/o,p=(i.top+(u&&a?a.offsetTop:0))/r,m=i.width/o,y=i.height/r;return{width:m,height:y,top:p,right:l+m,bottom:p+y,left:l,x:l,y:p}}function g(e){var t=s(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function v(e){return e?(e.nodeName||"").toLowerCase():null}function b(e){return((d(e)?e.ownerDocument:e.document)||window.document).documentElement}function w(e){return y(b(e)).left+g(e).scrollLeft}function S(e){return s(e).getComputedStyle(e)}function _(e){var t=S(e),n=t.overflow,i=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+i)}function I(e,t,n){void 0===n&&(n=!1);var i,o,r=c(t),a=c(t)&&function(e){var t=e.getBoundingClientRect(),n=h(t.width)/e.offsetWidth||1,i=h(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),d=b(t),u=y(e,a,n),l={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(r||!r&&!n)&&(("body"!==v(t)||_(d))&&(l=(i=t)!==s(i)&&c(i)?{scrollLeft:(o=i).scrollLeft,scrollTop:o.scrollTop}:g(i)),c(t)?((p=y(t,!0)).x+=t.clientLeft,p.y+=t.clientTop):d&&(p.x=w(d))),{x:u.left+l.scrollLeft-p.x,y:u.top+l.scrollTop-p.y,width:u.width,height:u.height}}function C(e){var t=y(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function P(e){return"html"===v(e)?e:e.assignedSlot||e.parentNode||(u(e)?e.host:null)||b(e)}function O(e){return["html","body","#document"].indexOf(v(e))>=0?e.ownerDocument.body:c(e)&&_(e)?e:O(P(e))}function E(e,t){var n;void 0===t&&(t=[]);var i=O(e),o=i===(null==(n=e.ownerDocument)?void 0:n.body),r=s(i),a=o?[r].concat(r.visualViewport||[],_(i)?i:[]):i,d=t.concat(a);return o?d:d.concat(E(P(a)))}function k(e){return["table","td","th"].indexOf(v(e))>=0}function M(e){return c(e)&&"fixed"!==S(e).position?e.offsetParent:null}function x(e){for(var t=s(e),n=M(e);n&&k(n)&&"static"===S(n).position;)n=M(n);return n&&("html"===v(n)||"body"===v(n)&&"static"===S(n).position)?t:n||function(e){var t=/firefox/i.test(m());if(/Trident/i.test(m())&&c(e)&&"fixed"===S(e).position)return null;var n=P(e);for(u(n)&&(n=n.host);c(n)&&["html","body"].indexOf(v(n))<0;){var i=S(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}var A="top",N="bottom",T="right",D="left",z="auto",B=[A,N,T,D],L="start",j="end",R="viewport",U="popper",V=B.reduce((function(e,t){return e.concat([t+"-"+L,t+"-"+j])}),[]),F=[].concat(B,[z]).reduce((function(e,t){return e.concat([t,t+"-"+L,t+"-"+j])}),[]),H=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function q(e){var t=new Map,n=new Set,i=[];function o(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&o(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||o(e)})),i}var W={placement:"bottom",modifiers:[],strategy:"absolute"};function K(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function $(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,o=t.defaultOptions,r=void 0===o?W:o;return function(e,t,n){void 0===n&&(n=r);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},W,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},c=[],u=!1,l={state:s,setOptions:function(n){var o="function"==typeof n?n(s.options):n;p(),s.options=Object.assign({},r,s.options,o),s.scrollParents={reference:d(e)?E(e):e.contextElement?E(e.contextElement):[],popper:E(t)};var a,u,h=function(e){var t=q(e);return H.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}((a=[].concat(i,s.options.modifiers),u=a.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{}),Object.keys(u).map((function(e){return u[e]}))));return s.orderedModifiers=h.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var r=o({state:s,name:t,instance:l,options:i}),a=function(){};c.push(r||a)}})),l.update()},forceUpdate:function(){if(!u){var e=s.elements,t=e.reference,n=e.popper;if(K(t,n)){s.rects={reference:I(t,x(n),"fixed"===s.options.strategy),popper:C(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<s.orderedModifiers.length;i++)if(!0!==s.reset){var o=s.orderedModifiers[i],r=o.fn,a=o.options,d=void 0===a?{}:a,c=o.name;"function"==typeof r&&(s=r({state:s,options:d,name:c,instance:l})||s)}else s.reset=!1,i=-1}}},update:(o=function(){return new Promise((function(e){l.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){p(),u=!0}};if(!K(e,t))return l;function p(){c.forEach((function(e){return e()})),c=[]}return l.setOptions(n).then((function(e){!u&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var G={passive:!0};function Y(e){return e.split("-")[0]}function X(e){return e.split("-")[1]}function J(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Z(e){var t,n=e.reference,i=e.element,o=e.placement,r=o?Y(o):null,a=o?X(o):null,s=n.x+n.width/2-i.width/2,d=n.y+n.height/2-i.height/2;switch(r){case A:t={x:s,y:n.y-i.height};break;case N:t={x:s,y:n.y+n.height};break;case T:t={x:n.x+n.width,y:d};break;case D:t={x:n.x-i.width,y:d};break;default:t={x:n.x,y:n.y}}var c=r?J(r):null;if(null!=c){var u="y"===c?"height":"width";switch(a){case L:t[c]=t[c]-(n[u]/2-i[u]/2);break;case j:t[c]=t[c]+(n[u]/2-i[u]/2)}}return t}var Q={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ee(e){var t,n=e.popper,i=e.popperRect,o=e.placement,r=e.variation,a=e.offsets,d=e.position,c=e.gpuAcceleration,u=e.adaptive,l=e.roundOffsets,p=e.isFixed,m=a.x,f=void 0===m?0:m,y=a.y,g=void 0===y?0:y,v="function"==typeof l?l({x:f,y:g}):{x:f,y:g};f=v.x,g=v.y;var w=a.hasOwnProperty("x"),_=a.hasOwnProperty("y"),I=D,C=A,P=window;if(u){var O=x(n),E="clientHeight",k="clientWidth";if(O===s(n)&&"static"!==S(O=b(n)).position&&"absolute"===d&&(E="scrollHeight",k="scrollWidth"),o===A||(o===D||o===T)&&r===j)C=N,g-=(p&&O===P&&P.visualViewport?P.visualViewport.height:O[E])-i.height,g*=c?1:-1;if(o===D||(o===A||o===N)&&r===j)I=T,f-=(p&&O===P&&P.visualViewport?P.visualViewport.width:O[k])-i.width,f*=c?1:-1}var M,z=Object.assign({position:d},u&&Q),B=!0===l?function(e,t){var n=e.x,i=e.y,o=t.devicePixelRatio||1;return{x:h(n*o)/o||0,y:h(i*o)/o||0}}({x:f,y:g},s(n)):{x:f,y:g};return f=B.x,g=B.y,c?Object.assign({},z,((M={})[C]=_?"0":"",M[I]=w?"0":"",M.transform=(P.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",M)):Object.assign({},z,((t={})[C]=_?g+"px":"",t[I]=w?f+"px":"",t.transform="",t))}const te={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,o=n.offset,r=void 0===o?[0,0]:o,a=F.reduce((function(e,n){return e[n]=function(e,t,n){var i=Y(e),o=[D,A].indexOf(i)>=0?-1:1,r="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=r[0],s=r[1];return a=a||0,s=(s||0)*o,[D,T].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,r),e}),{}),s=a[t.placement],d=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=d,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=a}};var ne={left:"right",right:"left",bottom:"top",top:"bottom"};function ie(e){return e.replace(/left|right|bottom|top/g,(function(e){return ne[e]}))}var oe={start:"end",end:"start"};function re(e){return e.replace(/start|end/g,(function(e){return oe[e]}))}function ae(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&u(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function se(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function de(e,t,n){return t===R?se(function(e,t){var n=s(e),i=b(e),o=n.visualViewport,r=i.clientWidth,a=i.clientHeight,d=0,c=0;if(o){r=o.width,a=o.height;var u=f();(u||!u&&"fixed"===t)&&(d=o.offsetLeft,c=o.offsetTop)}return{width:r,height:a,x:d+w(e),y:c}}(e,n)):d(t)?function(e,t){var n=y(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):se(function(e){var t,n=b(e),i=g(e),o=null==(t=e.ownerDocument)?void 0:t.body,r=l(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=l(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-i.scrollLeft+w(e),d=-i.scrollTop;return"rtl"===S(o||n).direction&&(s+=l(n.clientWidth,o?o.clientWidth:0)-r),{width:r,height:a,x:s,y:d}}(b(e)))}function ce(e,t,n,i){var o="clippingParents"===t?function(e){var t=E(P(e)),n=["absolute","fixed"].indexOf(S(e).position)>=0&&c(e)?x(e):e;return d(n)?t.filter((function(e){return d(e)&&ae(e,n)&&"body"!==v(e)})):[]}(e):[].concat(t),r=[].concat(o,[n]),a=r[0],s=r.reduce((function(t,n){var o=de(e,n,i);return t.top=l(o.top,t.top),t.right=p(o.right,t.right),t.bottom=p(o.bottom,t.bottom),t.left=l(o.left,t.left),t}),de(e,a,i));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function ue(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function le(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function pe(e,t){void 0===t&&(t={});var n=t,i=n.placement,o=void 0===i?e.placement:i,r=n.strategy,a=void 0===r?e.strategy:r,s=n.boundary,c=void 0===s?"clippingParents":s,u=n.rootBoundary,l=void 0===u?R:u,p=n.elementContext,h=void 0===p?U:p,m=n.altBoundary,f=void 0!==m&&m,g=n.padding,v=void 0===g?0:g,w=ue("number"!=typeof v?v:le(v,B)),S=h===U?"reference":U,_=e.rects.popper,I=e.elements[f?S:h],C=ce(d(I)?I:I.contextElement||b(e.elements.popper),c,l,a),P=y(e.elements.reference),O=Z({reference:P,element:_,strategy:"absolute",placement:o}),E=se(Object.assign({},_,O)),k=h===U?E:P,M={top:C.top-k.top+w.top,bottom:k.bottom-C.bottom+w.bottom,left:C.left-k.left+w.left,right:k.right-C.right+w.right},x=e.modifiersData.offset;if(h===U&&x){var D=x[o];Object.keys(M).forEach((function(e){var t=[T,N].indexOf(e)>=0?1:-1,n=[A,N].indexOf(e)>=0?"y":"x";M[e]+=D[n]*t}))}return M}function he(e,t,n){return l(e,p(t,n))}const me={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,o=n.mainAxis,r=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,d=n.boundary,c=n.rootBoundary,u=n.altBoundary,h=n.padding,m=n.tether,f=void 0===m||m,y=n.tetherOffset,g=void 0===y?0:y,v=pe(t,{boundary:d,rootBoundary:c,padding:h,altBoundary:u}),b=Y(t.placement),w=X(t.placement),S=!w,_=J(b),I="x"===_?"y":"x",P=t.modifiersData.popperOffsets,O=t.rects.reference,E=t.rects.popper,k="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,M="number"==typeof k?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),z=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,B={x:0,y:0};if(P){if(r){var j,R="y"===_?A:D,U="y"===_?N:T,V="y"===_?"height":"width",F=P[_],H=F+v[R],q=F-v[U],W=f?-E[V]/2:0,K=w===L?O[V]:E[V],$=w===L?-E[V]:-O[V],G=t.elements.arrow,Z=f&&G?C(G):{width:0,height:0},Q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},ee=Q[R],te=Q[U],ne=he(0,O[V],Z[V]),ie=S?O[V]/2-W-ne-ee-M.mainAxis:K-ne-ee-M.mainAxis,oe=S?-O[V]/2+W+ne+te+M.mainAxis:$+ne+te+M.mainAxis,re=t.elements.arrow&&x(t.elements.arrow),ae=re?"y"===_?re.clientTop||0:re.clientLeft||0:0,se=null!=(j=null==z?void 0:z[_])?j:0,de=F+oe-se,ce=he(f?p(H,F+ie-se-ae):H,F,f?l(q,de):q);P[_]=ce,B[_]=ce-F}if(s){var ue,le="x"===_?A:D,me="x"===_?N:T,fe=P[I],ye="y"===I?"height":"width",ge=fe+v[le],ve=fe-v[me],be=-1!==[A,D].indexOf(b),we=null!=(ue=null==z?void 0:z[I])?ue:0,Se=be?ge:fe-O[ye]-E[ye]-we+M.altAxis,_e=be?fe+O[ye]+E[ye]-we-M.altAxis:ve,Ie=f&&be?function(e,t,n){var i=he(e,t,n);return i>n?n:i}(Se,fe,_e):he(f?Se:ge,fe,f?_e:ve);P[I]=Ie,B[I]=Ie-fe}t.modifiersData[i]=B}},requiresIfExists:["offset"]};const fe={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,o=e.options,r=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Y(n.placement),d=J(s),c=[D,T].indexOf(s)>=0?"height":"width";if(r&&a){var u=function(e,t){return ue("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:le(e,B))}(o.padding,n),l=C(r),p="y"===d?A:D,h="y"===d?N:T,m=n.rects.reference[c]+n.rects.reference[d]-a[d]-n.rects.popper[c],f=a[d]-n.rects.reference[d],y=x(r),g=y?"y"===d?y.clientHeight||0:y.clientWidth||0:0,v=m/2-f/2,b=u[p],w=g-l[c]-u[h],S=g/2-l[c]/2+v,_=he(b,S,w),I=d;n.modifiersData[i]=((t={})[I]=_,t.centerOffset=_-S,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&ae(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ye(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function ge(e){return[A,T,N,D].some((function(t){return e[t]>=0}))}var ve=$({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,o=i.scroll,r=void 0===o||o,a=i.resize,d=void 0===a||a,c=s(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&u.forEach((function(e){e.addEventListener("scroll",n.update,G)})),d&&c.addEventListener("resize",n.update,G),function(){r&&u.forEach((function(e){e.removeEventListener("scroll",n.update,G)})),d&&c.removeEventListener("resize",n.update,G)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=Z({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,o=void 0===i||i,r=n.adaptive,a=void 0===r||r,s=n.roundOffsets,d=void 0===s||s,c={placement:Y(t.placement),variation:X(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ee(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:d})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ee(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},o=t.elements[e];c(o)&&v(o)&&(Object.assign(o.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],o=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});c(i)&&v(i)&&(Object.assign(i.style,r),Object.keys(o).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]},te,{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var o=n.mainAxis,r=void 0===o||o,a=n.altAxis,s=void 0===a||a,d=n.fallbackPlacements,c=n.padding,u=n.boundary,l=n.rootBoundary,p=n.altBoundary,h=n.flipVariations,m=void 0===h||h,f=n.allowedAutoPlacements,y=t.options.placement,g=Y(y),v=d||(g===y||!m?[ie(y)]:function(e){if(Y(e)===z)return[];var t=ie(e);return[re(e),t,re(t)]}(y)),b=[y].concat(v).reduce((function(e,n){return e.concat(Y(n)===z?function(e,t){void 0===t&&(t={});var n=t,i=n.placement,o=n.boundary,r=n.rootBoundary,a=n.padding,s=n.flipVariations,d=n.allowedAutoPlacements,c=void 0===d?F:d,u=X(i),l=u?s?V:V.filter((function(e){return X(e)===u})):B,p=l.filter((function(e){return c.indexOf(e)>=0}));0===p.length&&(p=l);var h=p.reduce((function(t,n){return t[n]=pe(e,{placement:n,boundary:o,rootBoundary:r,padding:a})[Y(n)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}(t,{placement:n,boundary:u,rootBoundary:l,padding:c,flipVariations:m,allowedAutoPlacements:f}):n)}),[]),w=t.rects.reference,S=t.rects.popper,_=new Map,I=!0,C=b[0],P=0;P<b.length;P++){var O=b[P],E=Y(O),k=X(O)===L,M=[A,N].indexOf(E)>=0,x=M?"width":"height",j=pe(t,{placement:O,boundary:u,rootBoundary:l,altBoundary:p,padding:c}),R=M?k?T:D:k?N:A;w[x]>S[x]&&(R=ie(R));var U=ie(R),H=[];if(r&&H.push(j[E]<=0),s&&H.push(j[R]<=0,j[U]<=0),H.every((function(e){return e}))){C=O,I=!1;break}_.set(O,H)}if(I)for(var q=function(e){var t=b.find((function(t){var n=_.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},W=m?3:1;W>0;W--){if("break"===q(W))break}t.placement!==C&&(t.modifiersData[i]._skip=!0,t.placement=C,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},me,fe,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,o=t.rects.popper,r=t.modifiersData.preventOverflow,a=pe(t,{elementContext:"reference"}),s=pe(t,{altBoundary:!0}),d=ye(a,i),c=ye(s,o,r),u=ge(d),l=ge(c);t.modifiersData[n]={referenceClippingOffsets:d,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:l},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":l})}}]}),be=n(21654),we=n.n(be),Se=[],_e=function(e,t,n){void 0===n&&(n={});var o=i.useRef(null),s={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||Se},d=i.useState({styles:{popper:{position:s.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),c=d[0],u=d[1],l=i.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,n=Object.keys(t.elements);a.flushSync((function(){u({styles:(0,r.PW)(n.map((function(e){return[e,t.styles[e]||{}]}))),attributes:(0,r.PW)(n.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),p=i.useMemo((function(){var e={onFirstUpdate:s.onFirstUpdate,placement:s.placement,strategy:s.strategy,modifiers:[].concat(s.modifiers,[l,{name:"applyStyles",enabled:!1}])};return we()(o.current,e)?o.current||e:(o.current=e,e)}),[s.onFirstUpdate,s.placement,s.strategy,s.modifiers,l]),h=i.useRef();return(0,r.Es)((function(){h.current&&h.current.setOptions(p)}),[p]),(0,r.Es)((function(){if(null!=e&&null!=t){var i=(n.createPopper||ve)(e,t,p);return h.current=i,function(){i.destroy(),h.current=null}}}),[e,t,n.createPopper]),{state:h.current?h.current.state:null,styles:c.styles,attributes:c.attributes,update:h.current?h.current.update:null,forceUpdate:h.current?h.current.forceUpdate:null}},Ie=function(){},Ce=function(){return Promise.resolve(null)},Pe=[];function Oe(e){var t=e.placement,n=void 0===t?"bottom":t,a=e.strategy,s=void 0===a?"absolute":a,d=e.modifiers,c=void 0===d?Pe:d,u=e.referenceElement,l=e.onFirstUpdate,p=e.innerRef,h=e.children,m=i.useContext(o.kr),f=i.useState(null),y=f[0],g=f[1],v=i.useState(null),b=v[0],w=v[1];i.useEffect((function(){(0,r.cZ)(p,y)}),[p,y]);var S=i.useMemo((function(){return{placement:n,strategy:s,onFirstUpdate:l,modifiers:[].concat(c,[{name:"arrow",enabled:null!=b,options:{element:b}}])}}),[n,s,l,c,b]),_=_e(u||m,y,S),I=_.state,C=_.styles,P=_.forceUpdate,O=_.update,E=i.useMemo((function(){return{ref:g,style:C.popper,placement:I?I.placement:n,hasPopperEscaped:I&&I.modifiersData.hide?I.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:I&&I.modifiersData.hide?I.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:C.arrow,ref:w},forceUpdate:P||Ie,update:O||Ce}}),[g,w,n,I,C,O,P]);return(0,r.vq)(h)(E)}},77175:(e,t,n)=>{"use strict";n.d(t,{$$:()=>r,kr:()=>o,mS:()=>a});var i=n(70355),o=i.createContext(),r=i.createContext();function a(e){var t=e.children,n=i.useState(null),a=n[0],s=n[1],d=i.useRef(!1);i.useEffect((function(){return function(){d.current=!0}}),[]);var c=i.useCallback((function(e){d.current||s(e)}),[]);return i.createElement(o.Provider,{value:a},i.createElement(r.Provider,{value:c},t))}},99315:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});class i extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class o extends i{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}class r{constructor(e){this._paymentIntegrationService=e}execute(e,t){return n=this,o=function*(){return yield this._paymentIntegrationService.submitOrder(e,t),Promise.resolve()},new((i=void 0)||(i=Promise))((function(e,t){function r(e){try{s(o.next(e))}catch(e){t(e)}}function a(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(r,a)}s((o=o.apply(n,[])).next())}));var n,i,o}finalize(){return Promise.reject(new o)}initialize(){return Promise.resolve()}deinitialize(){return Promise.resolve()}}const a=(s=e=>new r(e),d=[{id:"testgateway"}],Object.assign(s,{resolveIds:d}));var s,d}}]);
//# sourceMappingURL=vendor-async-2f932e74.js.map