"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[7747],{7362:(e,t,n)=>{n.d(t,{HostedPaymentMethod:()=>r});var s=n(70355),i=n(19285),a=n(31698);const r=(0,i.A)((({checkoutService:e,checkoutState:t,method:n,onUnhandledError:i,language:r,paymentForm:l})=>s.createElement(a.A,{checkoutService:e,checkoutState:t,deinitializePayment:e.deinitializePayment,initializePayment:e.initializePayment,language:r,method:n,onUnhandledError:i,paymentForm:l})),[{gateway:"afterpay"},{id:"quadpay"},{id:"sezzle"},{id:"zip"}])},31698:(e,t,n)=>{n.d(t,{A:()=>c});var s=n(31635),i=n(44218),a=n(69440),r=n(70355),l=n(65685),o=n(94611),d=n(11474),m=n(40646),u=n(91182);const c=e=>{const{description:t,isInitializing:n=!1,initializePayment:c,method:p,onUnhandledError:h=a.noop,deinitializePayment:I}=e,[g,y]=(0,r.useState)(!1),[E,w]=(0,r.useState)(),C=function(e){const t=(0,i.B4)(((e=[])=>e.filter(l.A))),n=(0,i.B4)(((e=[])=>e.filter((({trustedShippingAddress:e})=>e)))),{checkoutService:s,checkoutState:a,isUsingMultiShipping:r=!1,method:d}=e,{data:{getCart:m,getConfig:u,getCustomer:c,getInstruments:p,isPaymentDataRequired:h,isPaymentDataSubmitted:I},statuses:{isLoadingInstruments:g}}=a,y=m(),E=u(),w=c();if(!E||!y||!w)throw new Error("Unable to get checkout");const C=t(p(d)),v=n(C);return{instruments:v,isNewAddress:0===v.length&&C.length>0,isInstrumentFeatureAvailable:!I(d.id,d.gateway)&&(0,o.A)({config:E,customer:w,isUsingMultiShipping:r,paymentMethod:d}),isLoadingInstruments:g(),isPaymentDataRequired:h(),loadInstruments:s.loadInstruments}}(e),{isLoadingInstruments:v,instruments:f,isNewAddress:A,isInstrumentFeatureAvailable:k,loadInstruments:N}=C,b=(0,r.useCallback)((()=>{if(!g&&f.length)return(0,a.find)(f,{defaultInstrument:!0})||f[0]}),[g,f]),S=(0,r.useCallback)((()=>{y(!0),w(void 0)}),[]),_=(0,r.useCallback)((e=>{y(!1),w((0,a.find)(f,{bigpayToken:e}))}),[f]);(0,r.useEffect)((()=>((0,s.__awaiter)(void 0,void 0,void 0,(function*(){try{yield c({gatewayId:p.gateway,methodId:p.id}),k&&(yield N())}catch(e){h(e)}})),()=>{(0,s.__awaiter)(void 0,void 0,void 0,(function*(){try{yield I({gatewayId:p.gateway,methodId:p.id})}catch(e){h(e)}}))})),[]);const M=E||b(),U=n||v,z=k&&(f.length>0||A);return t||k?r.createElement(u.A,{hideContentWhenLoading:!0,isLoading:U},r.createElement("div",{className:"paymentMethod paymentMethod--hosted"},t,z&&r.createElement(d.A,{instruments:f,onSelectInstrument:_,onUseNewInstrument:S,selectedInstrument:M}),k&&r.createElement(m.A,{instrumentId:M&&M.bigpayToken,instruments:f,isAccountInstrument:!0}))):null}},42518:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H});var s=n(31635),i=n(44218),a=n(69440),r=n(70355),l=n(68512),o=n(91182),d=n(45293),m=n(83742),u=n(49655),c=n(48447),p=n(60833),h=n(43586),I=n(29853),g=n(91589),y=n(3375),E=n.n(y),w=n(67113),C=n(97712),v=n(45080);const f=(0,v.A)((()=>r.createElement("svg",{height:"25",viewBox:"0 0 35 25",width:"35",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{clipRule:"evenodd",d:"M33 2H2L2 23H33V2ZM2 0C0.895431 0 0 0.89543 0 2V23C0 24.1046 0.89543 25 2 25H33C34.1046 25 35 24.1046 35 23V2C35 0.89543 34.1046 0 33 0H2Z",fill:"#D1D7E0",fillRule:"evenodd"}),r.createElement("path",{clipRule:"evenodd",d:"M11 12C11 11.4477 11.4477 11 12 11H24C24.5523 11 25 11.4477 25 12V14C25 14.5523 24.5523 15 24 15H12C11.4477 15 11 14.5523 11 14V12Z",fill:"#D1D7E0",fillRule:"evenodd"}),r.createElement("path",{clipRule:"evenodd",d:"M19 6C19.5523 6 20 6.44772 20 7V19C20 19.5523 19.5523 20 19 20H17C16.4477 20 16 19.5523 16 19V7C16 6.44772 16.4477 6 17 6H19Z",fill:"#D1D7E0",fillRule:"evenodd"}))));var A=n(96131);class k extends r.PureComponent{componentDidMount(){const{selectedInstrumentId:e}=this.props;setTimeout((()=>this.updateFieldValue(e)))}componentDidUpdate(e){const{selectedInstrumentId:t}=e,{selectedInstrumentId:n}=this.props;t!==n&&this.updateFieldValue(n)}componentWillUnmount(){const{selectedInstrumentId:e,field:t}=this.props;""===t.value&&void 0!==e&&this.updateFieldValue()}render(){const{field:e,instruments:t,onSelectInstrument:n,onUseNewInstrument:i,selectedInstrumentId:l}=this.props,o=(0,a.find)(t,{bigpayToken:l}),{value:d}=e,m=(0,s.__rest)(e,["value"]);return r.createElement("div",{className:"instrumentSelect"},r.createElement(w.A,{dropdown:r.createElement(N,{instruments:t,onSelectInstrument:n,onUseNewInstrument:i,selectedInstrumentId:l})},r.createElement(b,{instrument:o,testId:"instrument-select"}),r.createElement("input",Object.assign({type:"hidden",value:d||""},m))))}updateFieldValue(e=""){const{form:t,field:n}=this.props;t.setFieldValue(n.name,e)}}const N=({instruments:e,selectedInstrumentId:t,onSelectInstrument:n,onUseNewInstrument:s})=>r.createElement("ul",{className:"instrumentSelect-dropdownMenu instrumentSelect-dropdownMenuNext dropdown-menu","data-test":"instrument-select-menu"},e.map((e=>r.createElement("li",{className:E()("instrumentSelect-option dropdown-menu-item",{"instrumentSelect-option--selected":e.bigpayToken===t}),key:e.bigpayToken},r.createElement(S,{instrument:e,onClick:n,testId:"instrument-select-option"})))),r.createElement("li",{className:"instrumentSelect-option instrumentSelect-option--addNew dropdown-menu-item"},r.createElement(U,{onClick:s,testId:"instrument-select-option-use-new"}))),b=({instrument:e,testId:t,onClick:n})=>e?(0,A.A)(e)?r.createElement(M,{className:"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input",instrument:e,onClick:n,testId:t}):r.createElement(_,{className:"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input",instrument:e,onClick:n,testId:t}):r.createElement(U,{className:"instrumentSelect-button optimizedCheckout-form-select dropdown-button form-input",testId:t}),S=({instrument:e,onClick:t=a.noop})=>{const n=(0,r.useCallback)((()=>{t(e.bigpayToken)}),[t,e]);return(0,A.A)(e)?r.createElement(M,{instrument:e,onClick:n,testId:"instrument-select-option"}):r.createElement(_,{instrument:e,onClick:n,testId:"instrument-select-option"})},_=({className:e,instrument:{externalId:t},testId:n,onClick:s})=>r.createElement("button",{className:e,"data-test":n,onClick:s,type:"button"},r.createElement("div",{className:"instrumentSelect-details"},r.createElement(C.A,{additionalClassName:"accountIcon-icon",size:v.l.Medium}),r.createElement("div",{className:"instrumentSelect-account","data-test":`${n}-externalId`},t))),M=({className:e,instrument:t,testId:n,onClick:s})=>r.createElement("button",{className:e,"data-test":n,onClick:s,type:"button"},r.createElement("div",{className:"instrumentSelect-details"},r.createElement("div",{className:"instrumentSelect-card"},r.createElement(u.A,{data:{accountNumber:t.accountNumber},id:"payment.instrument_account_number_ending"})),r.createElement("div",{className:"instrumentSelect-issuer"},r.createElement(u.A,{id:"payment.instrument_issuer"}),": ",t.issuer))),U=({className:e,testId:t,onClick:n=a.noop})=>r.createElement("button",{className:e,"data-test":t,onClick:n,type:"button"},r.createElement("div",{className:"instrumentSelect-details instrumentSelect-details--addNew"},r.createElement(f,{additionalClassName:"accountIcon-icon",size:v.l.Medium}),r.createElement("div",{className:"instrumentSelect-account"},r.createElement(u.A,{id:"payment.account_instrument_add_action"})))),z=k;var D=n(42291);const P=(0,r.memo)((({instruments:e,onSelectInstrument:t,onUseNewInstrument:n,selectedInstrument:s})=>{const i=(0,r.useCallback)((i=>r.createElement(z,Object.assign({},i,{instruments:e,onSelectInstrument:t,onUseNewInstrument:n,selectedInstrumentId:s&&s.bigpayToken}))),[e,t,n,s]),a=(0,r.useCallback)((t=>r.createElement(D.A,Object.assign({instruments:e},t))),[e]);return r.createElement(p.A,{additionalClassName:"instrumentFieldset",legend:r.createElement(h.A,{hidden:!0},r.createElement(u.A,{id:"payment.account_instrument_text"}))},r.createElement(g.A,{modal:a},(({onClick:e})=>r.createElement("button",{className:"instrumentModal-trigger",onClick:e,type:"button"},r.createElement(u.A,{id:"payment.instrument_manage_button"})))),r.createElement(I.A,{name:"instrumentId",render:i}),0===e.length&&r.createElement("div",{className:"instrumentSelect-note"},r.createElement(c.A,{id:"payment.account_instrument_new_shipping_address"})))}));var V=n(77269),F=n(13363),L=n(98873),R=n(67874);class T extends r.Component{constructor(){super(...arguments),this.state={isAddingNewInstrument:!1},this.handleUseNewInstrument=()=>{this.setState({isAddingNewInstrument:!0,selectedInstrument:void 0})},this.handleSelectInstrument=e=>{const{instruments:t}=this.props;this.setState({isAddingNewInstrument:!1,selectedInstrument:(0,a.find)(t,{bigpayToken:e})})}}componentDidMount(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{initializePayment:e,isInstrumentFeatureAvailable:t,loadInstruments:n,method:s,onUnhandledError:i=a.noop}=this.props;try{yield e({gatewayId:s.gateway,methodId:s.id}),t&&(yield n())}catch(e){i(e)}}))}componentWillUnmount(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const{deinitializePayment:e,method:t,onUnhandledError:n=a.noop}=this.props;try{yield e({gatewayId:t.gateway,methodId:t.id})}catch(e){n(e)}}))}render(){const{description:e,isInitializing:t=!1,isLoadingInstruments:n,instruments:s,isNewAddress:i,isInstrumentFeatureAvailable:a}=this.props,{selectedInstrument:l=this.getDefaultInstrument()}=this.state,d=t||n,m=a&&(s.length>0||i);return e||a?r.createElement(o.A,{hideContentWhenLoading:!0,isLoading:d},r.createElement("div",{className:"paymentMethod paymentMethod--hosted"},e,m&&r.createElement(P,{instruments:s,onSelectInstrument:this.handleSelectInstrument,onUseNewInstrument:this.handleUseNewInstrument,selectedInstrument:l}),a&&r.createElement(L.A,{instrumentId:l&&l.bigpayToken,isAccountInstrument:!0}))):null}getDefaultInstrument(){const{isAddingNewInstrument:e}=this.state,{instruments:t}=this.props;if(!e&&t.length)return(0,a.find)(t,{defaultInstrument:!0})||t[0]}}const H=(0,m.A)((0,l.A)((0,R.A)((0,d.A)((()=>{const e=(0,i.B4)(((e=[])=>e.filter(V.A))),t=(0,i.B4)(((e=[])=>e.filter((({trustedShippingAddress:e})=>e))));return(n,s)=>{const{method:i}=s,{checkoutService:a,checkoutState:r}=n,{data:{getCart:l,getConfig:o,getCustomer:d,getInstruments:m,isPaymentDataRequired:u,isPaymentDataSubmitted:c},statuses:{isLoadingInstruments:p}}=r,h=l(),I=o(),g=d();if(!(I&&h&&g&&i))return null;const y=e(m(i)),E=t(y);return{instruments:E,isNewAddress:0===E.length&&y.length>0,isInstrumentFeatureAvailable:!c(i.id,i.gateway)&&(0,F.A)({config:I,customer:g,paymentMethod:i}),isLoadingInstruments:p(),isPaymentDataRequired:u(),loadInstruments:a.loadInstruments}}}))(T))))},94611:(e,t,n)=>{function s({config:e,customer:t,isUsingMultiShipping:n,paymentMethod:s}){return!(!e.checkoutSettings.isCardVaultingEnabled||!s.config.isVaultingEnabled||t.isGuest||n)}n.d(t,{A:()=>s})}}]);
//# sourceMappingURL=hosted-payment-method-b6d73f7b.js.map