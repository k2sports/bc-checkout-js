"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[6051,9154],{12929:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(70355),r=n(49655),i=n(88186),d=n(30680);const o=({appearFocused:e,id:t,name:n})=>{const o=(0,a.useCallback)((()=>a.createElement(i.A,{appearFocused:e,id:t})),[t,e]);return a.createElement(d.A,{additionalClassName:"form-field--ccExpiry",input:o,labelContent:a.createElement(r.A,{id:"payment.credit_card_expiration_label"}),name:n})}},36659:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(70355),r=n(49655),i=n(88186),d=n(30680),o=n(14456);const s=({appearFocused:e,id:t,name:n})=>{const s=(0,a.useCallback)((()=>a.createElement(a.Fragment,null,a.createElement(i.A,{additionalClassName:"has-icon",appearFocused:e,id:t}),a.createElement(o.A,null))),[t,e]);return a.createElement(d.A,{additionalClassName:"form-field--ccNumber",input:s,labelContent:a.createElement(r.A,{id:"payment.credit_card_number_label"}),name:n})}},39527:(e,t,n)=>{n.d(t,{i:()=>l});var a=n(31635),r=n(69440),i=n(70355),d=n(82804),o=n(48407),s=n(31448),c=n(98363);const l=({checkoutState:e,method:t,language:n,paymentForm:l})=>{const{setFieldTouched:u,setFieldValue:m,setSubmitted:p,submitForm:y}=l,{config:h}=t,{cardCode:v}=h,b=v||null===v,_=(0,o.A)(e),g=(0,s.A)(e),f=(0,i.useCallback)((e=>`${(0,r.compact)([t.gateway,t.id]).join("-")}-${e}`),[t]),[I,C]=(0,i.useState)();return{getHostedStoredCardValidationFieldset:(0,i.useCallback)((e=>{const n=!!e&&g(e,t),a=!!e&&_(e,t);return i.createElement(c.A,{cardCodeId:a?f("ccCvv"):void 0,cardNumberId:n?f("ccNumber"):void 0,focusedFieldType:I})}),[I,f,_,g,t]),getHostedFormOptions:(0,i.useCallback)((e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const a=["color","fontFamily","fontSize","fontWeight"],i=!!e&&g(e,t),o=!!e&&_(e,t);let s;return e?o?s=f("ccCvv"):i&&(s=f("ccNumber")):s=f("ccNumber"),{fields:e?{cardCodeVerification:o&&e?{accessibilityLabel:n.translate("payment.credit_card_cvv_label"),containerId:f("ccCvv"),instrumentId:e.bigpayToken}:void 0,cardNumberVerification:i&&e?{accessibilityLabel:n.translate("payment.credit_card_number_label"),containerId:f("ccNumber"),instrumentId:e.bigpayToken}:void 0}:{cardCode:b?{accessibilityLabel:n.translate("payment.credit_card_cvv_label"),containerId:f("ccCvv")}:void 0,cardExpiry:{accessibilityLabel:n.translate("payment.credit_card_expiration_label"),containerId:f("ccExpiry"),placeholder:n.translate("payment.credit_card_expiration_placeholder_text")},cardName:{accessibilityLabel:n.translate("payment.credit_card_name_label"),containerId:f("ccName")},cardNumber:{accessibilityLabel:n.translate("payment.credit_card_number_label"),containerId:f("ccNumber")}},styles:s?{default:yield(0,d.A)(s,a),error:yield(0,d.A)(s,a,d.S.Error),focus:yield(0,d.A)(s,a,d.S.Focus)}:{},onBlur:({fieldType:e})=>{I===e&&C(void 0)},onCardTypeChange:({cardType:e})=>{m("hostedForm.cardType",e)},onEnter:()=>{p(!0),y()},onFocus:({fieldType:e})=>{C(e)},onValidate:({errors:e={}})=>{(0,r.forIn)(e,((e=[],t)=>{var n,a;const r=`hostedForm.errors.${t}`;m(r,null!==(a=null===(n=e[0])||void 0===n?void 0:n.type)&&void 0!==a?a:""),e[0]&&u(r)}))}}}))),[I,f,b,_,g,n,t,u,m,p,y])}}},47459:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(70355),r=n(90767),i=n(49655),d=n(88186),o=n(30680),s=n(97429),c=n(2224),l=n(14456);const u=({appearFocused:e,id:t,name:n})=>{const u=(0,a.useCallback)((()=>a.createElement(a.Fragment,null,a.createElement(d.A,{additionalClassName:"has-icon",appearFocused:e,id:t}),a.createElement(l.A,null))),[t,e]),m=(0,a.useMemo)((()=>a.createElement(a.Fragment,null,a.createElement(i.A,{id:"payment.credit_card_cvv_label"}),a.createElement(s.A,{placement:"top-start",tooltip:a.createElement(r.A,null)},a.createElement("span",{className:"has-tip"},a.createElement(c.A,null))))),[]);return a.createElement(o.A,{additionalClassName:"form-ccFields-field--ccCvv",input:u,labelContent:m,name:n})}},66833:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(44218),r=n(94202);const i=(0,a.Bj)((function({language:e,isCardExpiryRequired:t=!1}){return(0,r.Ik)().shape({instrumentId:(0,r.Yj)().required(),hostedForm:(0,r.Ik)().required().shape({errors:(0,r.Ik)().required().shape(Object.assign({cardCodeVerification:(0,r.Yj)().test({message:e.translate("payment.credit_card_cvv_required_error"),test:e=>"required"!==e}).test({message:e.translate("payment.credit_card_cvv_invalid_error"),test:e=>"invalid_card_code"!==e}),cardNumberVerification:(0,r.Yj)().test({message:e.translate("payment.credit_card_number_required_error"),test:e=>"required"!==e}).test({message:e.translate("payment.credit_card_number_invalid_error"),test:e=>"invalid_card_number"!==e}).test({message:e.translate("payment.credit_card_number_mismatch_error"),test:e=>"mismatched_card_number"!==e})},t?{cardExpiryVerification:(0,r.Yj)().test({message:e.translate("payment.credit_card_expiration_required_error"),test:e=>"required"!==e}).test({message:e.translate("payment.credit_card_expiration_invalid_error"),test:e=>"invalid_card_expiry"!==e})}:{}))})})}))},68280:(e,t,n)=>{n.d(t,{MonerisPaymentMethod:()=>u});var a=n(31635),r=n(69440),i=n(70355),d=n(39527),o=n(66833),s=n(89799),c=n(48407),l=n(31448);const u=(0,n(19285).A)((e=>{var{language:t,paymentForm:n,checkoutState:u,checkoutService:m,method:p}=e,y=(0,a.__rest)(e,["language","paymentForm","checkoutState","checkoutService","method"]);const h="moneris-iframe-container",{getHostedStoredCardValidationFieldset:v,getHostedFormOptions:b}=(0,d.i)({checkoutState:u,method:p,language:t,paymentForm:n}),_=(0,o.A)({language:t}),{hidePaymentSubmitButton:g,disableSubmit:f,setFieldValue:I,setSubmit:C,setValidationSchema:E}=n,A=u.data.getInstruments(p)||[],{data:{getCheckout:F,isPaymentDataRequired:S},statuses:{isLoadingInstruments:k}}=u,w=F(),N=u.data.getCustomer(),V=!(null==N?void 0:N.isGuest)&&Boolean(p.config.isVaultingEnabled),x=(0,i.useCallback)(((e,t)=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const n=Object.assign(Object.assign({},e),{moneris:Object.assign({containerId:h},t&&{form:yield b(t)})});return m.initializePayment(n)}))),[h,b,m]);return i.createElement(s.A,Object.assign({containerId:h,deinitializePayment:m.deinitializePayment,disableSubmit:f,hidePaymentSubmitButton:g,initializePayment:x,instruments:A,isInstrumentCardCodeRequired:(0,c.A)(u),isInstrumentCardNumberRequired:(0,l.A)(u),isInstrumentFeatureAvailable:V,isLoadingInstruments:k(),isPaymentDataRequired:S(),isSignedIn:(0,r.some)(null==w?void 0:w.payments,{providerId:p.id}),loadInstruments:m.loadInstruments,method:p,setFieldValue:I,setSubmit:C,setValidationSchema:E,signOut:m.signOutCustomer,storedCardValidationSchema:_,validateInstrument:(e,t)=>v(t)},y))}),[{id:"moneris"}])},82804:(e,t,n)=>{n.d(t,{A:()=>u,S:()=>a});var a,r=n(69440),i=n(70355),d=n(54622),o=n(59713),s=n(9343),c=n(85216),l=n(10156);function u(e,t,n=a.Default){const u=document.createElement("div"),m=document.getElementById(e);if(!m)throw new Error("Unable to retrieve input styles as the provided container ID is not valid.");return m.appendChild(u),new Promise((e=>{d.render(i.createElement(s.Ay.Provider,{value:{isSubmitted:!0,setSubmitted:r.noop}},i.createElement(c.A,{hasError:n===a.Error},i.createElement(l.A,{appearFocused:n===a.Focus,ref:n=>{n&&(e((0,o.A)(n,t)),d.unmountComponentAtNode(u),u.parentElement&&u.parentElement.removeChild(u))}}))),u)}))}!function(e){e.Default="default",e.Error="error",e.Focus="focus"}(a||(a={}))},88186:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(31635),r=n(3375),i=n.n(r),d=n(70355);const o=e=>{var{additionalClassName:t,appearFocused:n,testId:r}=e,o=(0,a.__rest)(e,["additionalClassName","appearFocused","testId"]);return d.createElement("div",Object.assign({},o,{className:i()("form-input","optimizedCheckout-form-input",{"form-input--focus":n},{"optimizedCheckout-form-input--focus":n},t),"data-test":r}))}},89799:(e,t,n)=>{n.d(t,{A:()=>g});var a=n(31635),r=n(69440),i=n(70355),d=n(52137),o=n(43125),s=n(11474),c=n(62677),l=n(40646),u=n(91182),m=n(3375),p=n.n(m),y=n(72769),h=n(49655);const v=({buttonId:e,shouldShowEditButton:t})=>{if(t){const t=i.createElement(h.A,{id:"remote.select_different_card_action"});return i.createElement("p",null,i.createElement("button",{className:p()("stepHeader","widget-link-amazonpay"),id:e,onClick:(0,y.A)(),type:"button"},t))}return null},b=({shouldShowDescriptor:e,paymentDescriptor:t})=>e&&t?i.createElement("div",{className:"payment-descriptor"},t):null,_=({additionalContainerClassName:e,containerId:t,hideContentWhenSignedOut:n,hideWidget:a,isSignInRequired:r,isSignedIn:d,method:o,renderCustomPaymentForm:s,shouldRenderCustomInstrument:c,shouldShowCreditCardFieldset:l})=>i.createElement("div",{className:p()("widget",`widget--${o.id}`,"payment-widget",c?"":e),id:t,style:{display:n&&r&&!d||!l||a?"none":void 0},tabIndex:-1},c&&s&&s()),g=({instruments:e,hideWidget:t=!1,isInitializing:n=!1,isAccountInstrument:m,isInstrumentFeatureAvailable:p,isLoadingInstruments:y,shouldHideInstrumentExpiryDate:h=!1,shouldShow:g=!0,hideVerificationFields:f,method:I,storedCardValidationSchema:C,isPaymentDataRequired:E,setValidationSchema:A,loadInstruments:F,onUnhandledError:S=r.noop,deinitializeCustomer:k,deinitializePayment:w,setSubmit:N,initializeCustomer:V,initializePayment:x,signInCustomer:q,isSignedIn:T,isSignInRequired:R,isInstrumentCardNumberRequired:P,validateInstrument:D,containerId:z,hideContentWhenSignedOut:O=!1,renderCustomPaymentForm:j,additionalContainerClassName:L,shouldRenderCustomInstrument:B=!1,paymentDescriptor:W,shouldShowDescriptor:H,shouldShowEditButton:M,buttonId:U,setFieldValue:Y})=>{const[$,J]=(0,i.useState)(!1),[G,K]=(0,i.useState)(void 0),Q=(0,i.useRef)(e);(0,i.useEffect)((()=>{Q.current=e}),[e]);const X=(0,i.useCallback)((()=>{if($)return;const e=Q.current.find((e=>e.defaultInstrument))||Q.current[0];return e?e.bigpayToken:void 0}),[$]),Z=(0,i.useCallback)((()=>{const e=G||X();return(0,r.find)(Q.current,{bigpayToken:e})}),[G,X]),ee=(0,i.useCallback)((()=>{if(!E)return null;const e=Z();return p&&e&&C||null}),[Z,p,E,C]),te=(0,i.useCallback)(((e,t)=>!e&&(0,d.T)(t)?t:void 0),[]),ne=(0,i.useCallback)((t=>{if(0===e.length)return J(!0),K(void 0),void Y("instrumentId","");if(G===t){const e=X();K(e),Y("instrumentId",e)}}),[e,G,X]),ae=(0,i.useCallback)((()=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){J(!0),K(void 0),w&&(yield w({gatewayId:I.gateway,methodId:I.id})),x&&(yield x({gatewayId:I.gateway,methodId:I.id}))}))),[I,w,x]),re=(0,i.useCallback)((e=>{J(!1),K(e)}),[]),ie=(0,i.useCallback)((()=>{const t=G||X(),n=(0,r.find)(e,{bigpayToken:t});if(n){(0,o.A)(n);const e=P(n,I);if(f)return;if(D)return D(e,n)}}),[G,X,e,I,f,D]),de=()=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){const e=Q.current;if(!E)return void N(I,null);if(R&&!T)return N(I,q||null),V?V({methodId:I.id}):void 0;let t;if(N(I,null),!$){const n=G||X(),a=e.find((e=>e.bigpayToken===n))||e[0];a&&(0,o.a)(a)&&(t=a)}return x?x({gatewayId:I.gateway,methodId:I.id},t):void 0})),oe=G||X(),se=oe&&e.find((e=>e.bigpayToken===oe))||e[0],ce=e.filter((e=>!(0,d.T)(e))),le=e.filter((e=>(0,d.T)(e))),ue=p&&e.length>0,me=!ue||$,pe=(n||y)&&!t,ye=se?te($,se):void 0,he=e[0]&&(0,d.T)(e[0]);(0,i.useEffect)((()=>((0,a.__awaiter)(void 0,void 0,void 0,(function*(){A(I,ee());try{p&&(yield null==F?void 0:F()),yield de()}catch(e){e instanceof Error&&S(e)}})),()=>{(0,a.__awaiter)(void 0,void 0,void 0,(function*(){A(I,null),N(I,null);try{w&&(yield w({gatewayId:I.gateway,methodId:I.id})),k&&(yield k({methodId:I.id}))}catch(e){e instanceof Error&&S(e)}}))})),[]);const ve=(0,i.useRef)(!0),be=(0,i.useRef)(e.length),_e=(0,i.useRef)(E),ge=(0,i.useRef)(G);return(0,i.useEffect)((()=>{if(ve.current)return void(ve.current=!1);A(I,ee());(ge.current!==G||Number(be.current)>0&&0===e.length||_e.current!==E)&&(ge.current=G,be.current=e.length,_e.current=E,(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{w&&(yield w({gatewayId:I.gateway,methodId:I.id})),yield de()}catch(e){e instanceof Error&&S(e)}})))}),[G,e,E]),g?i.createElement(u.A,{hideContentWhenLoading:!0,isLoading:pe},i.createElement("div",{className:"paymentMethod--hosted"},he&&ue&&i.createElement(s.A,{instruments:le,onSelectInstrument:re,onUseNewInstrument:ae,selectedInstrument:ye}),!he&&ue&&i.createElement(c.A,{instruments:ce,onDeleteInstrument:ne,onSelectInstrument:re,onUseNewInstrument:ae,selectedInstrumentId:oe,shouldHideExpiryDate:h,validateInstrument:ie()}),i.createElement(b,{paymentDescriptor:W,shouldShowDescriptor:H}),i.createElement(_,{additionalContainerClassName:L,containerId:z,hideContentWhenSignedOut:O,hideWidget:t,isSignInRequired:R,isSignedIn:T,method:I,renderCustomPaymentForm:j,shouldRenderCustomInstrument:B,shouldShowCreditCardFieldset:me}),p&&i.createElement(l.A,{instrumentId:oe,instruments:e,isAccountInstrument:Boolean(m||he)}),i.createElement(v,{buttonId:U,shouldShowEditButton:M}))):i.createElement("div",{style:{display:"none"}})}},98363:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(70355),r=n(49655),i=n(36659),d=n(47459),o=n(12929);const s=({cardCodeId:e,cardNumberId:t,cardExpiryId:n,focusedFieldType:s})=>a.createElement(a.Fragment,null,t&&a.createElement("p",null,a.createElement("strong",null,a.createElement(r.A,{id:"payment.instrument_trusted_shipping_address_title_text"})),a.createElement("br",null),a.createElement(r.A,{id:"payment.instrument_trusted_shipping_address_text"})),a.createElement("div",{className:"form-ccFields"},t&&a.createElement(i.A,{appearFocused:"cardNumber"===s,id:t,name:"hostedForm.errors.cardNumberVerification"}),e&&a.createElement(d.A,{appearFocused:"cardCode"===s,id:e,name:"hostedForm.errors.cardCodeVerification"}),n&&a.createElement(o.A,{appearFocused:"cardExpiry"===s,id:n,name:"hostedForm.errors.cardExpiryVerification"})))}}]);
//# sourceMappingURL=moneris-payment-method-f57f8d50.js.map